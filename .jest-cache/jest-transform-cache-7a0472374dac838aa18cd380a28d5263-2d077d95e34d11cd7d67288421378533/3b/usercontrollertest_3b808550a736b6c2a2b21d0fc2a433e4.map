{"version":3,"sources":["C:\\Users\\USER\\Desktop\\guardian-grove\\guardian-grove-backend\\tests\\controllers\\user.controller.test.ts"],"sourcesContent":["import { testUtils } from '../setup';\r\nimport {  getUsers, getUserById, createUser, editUserProfile,\r\n    deleteUser, updatePassword, getUserStars, updateUserStars,\r\n    getUserCoins, updateUserCoins, getLocation, updateLocation,\r\n    getUserRank, getUserInterests, startAdventure, completeChallenge,\r\n    getUserAdventures, getUserPurchasedItems, getUserAvatar\r\n} from '../../src/controllers/user.controller';\r\nimport { User } from '../../src/models/user.model';\r\nimport * as generateSecurePassword from '../../src/utils/generateSecurePassword';\r\nimport * as checkId from '../../src/utils/checkId';\r\nimport { Adventure } from '../../src/models/adventure.model';\r\nimport { Family } from '../../src/models/family.model';\r\nimport * as emailService from '../../src/services/email.service';\r\nimport * as recalculateFamilyMemberRanks from '../../src/utils/recalculateFamilyMemberRanks';\r\nimport * as bcrypt from 'bcrypt';\r\n\r\n// Mock all dependencies\r\njest.mock('../../src/models/user.model');\r\njest.mock('../../src/models/adventure.model');\r\njest.mock('../../src/models/family.model');\r\njest.mock('../../src/services/email.service');\r\njest.mock('../../src/utils/generateSecurePassword');\r\njest.mock('../../src/utils/recalculateFamilyMemberRanks');\r\njest.mock('../../src/utils/checkId');\r\njest.mock('bcrypt');\r\n\r\nconst mockUser = User as jest.Mocked<typeof User>;\r\nconst mockAdventure = Adventure as jest.Mocked<typeof Adventure>;\r\nconst mockFamily = Family as jest.Mocked<typeof Family>;\r\nconst mockGenerateSecurePassword = generateSecurePassword as jest.Mocked<typeof generateSecurePassword>;\r\nconst mockCheckId = checkId as jest.Mocked<typeof checkId>;\r\nconst mockEmailService = emailService as jest.Mocked<typeof emailService>;\r\nconst mockRecalculateFamilyMemberRanks = recalculateFamilyMemberRanks as jest.Mocked<typeof recalculateFamilyMemberRanks>;\r\nconst mockBcrypt = bcrypt as jest.Mocked<typeof bcrypt>;\r\n\r\ndescribe('User Controller Tests', () => {\r\n    beforeEach(() => {\r\n        jest.clearAllMocks();\r\n        \r\n        // Setup User model methods\r\n        mockUser.find = jest.fn();\r\n        mockUser.findOne = jest.fn();\r\n        mockUser.findById = jest.fn();\r\n        mockUser.create = jest.fn();\r\n        mockUser.findByIdAndUpdate = jest.fn();\r\n        mockUser.findByIdAndDelete = jest.fn();\r\n        mockUser.countDocuments = jest.fn();\r\n\r\n        // Setup Adventure model methods\r\n        mockAdventure.findById = jest.fn();\r\n\r\n        // Setup Family model methods\r\n        mockFamily.findOne = jest.fn();\r\n        mockFamily.findById = jest.fn();\r\n        mockFamily.findByIdAndUpdate = jest.fn();\r\n        \r\n        // Setup utility mocks\r\n        mockGenerateSecurePassword.generateSecurePassword.mockReturnValue('TempPass123!');\r\n        mockCheckId.checkId.mockReturnValue(true);\r\n        jest.spyOn(mockEmailService, 'sendMail').mockResolvedValue(undefined);\r\n        jest.spyOn(mockRecalculateFamilyMemberRanks, 'recalculateFamilyMemberRanks').mockResolvedValue(undefined);\r\n        \r\n        (jest.spyOn(bcrypt, 'hash') as jest.Mock).mockResolvedValue('hashedPassword');\r\n        (jest.spyOn(bcrypt, 'compare') as jest.Mock).mockResolvedValue(true);\r\n    });\r\n\r\n    // 1. test getUsers API\r\n    describe('getUsers', () => {\r\n        it('should return all users successfully', async () => {\r\n            const mockUsers = [\r\n                testUtils.createMockUser({ name: 'John' }),\r\n                testUtils.createMockUser({ name: 'Jane', _id: '507f1f77bcf86cd799439013' })\r\n            ];\r\n            mockUser.find.mockResolvedValue(mockUsers as any);\r\n\r\n            const mockReq = testUtils.createMockRequest();\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUsers(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUser.find).toHaveBeenCalledTimes(1);\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith(mockUsers);\r\n        });\r\n\r\n        it('should handle database errors', async () => {\r\n            mockUser.find.mockRejectedValue(new Error('Database connection failed'));\r\n\r\n            const mockReq = testUtils.createMockRequest();\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUsers(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(500);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error retrieving users' });\r\n        });\r\n    });\r\n\r\n    // 2. test getUserById API\r\n    describe('getUserById', () => {\r\n        it('should return user by ID successfully', async () => {\r\n            const mockUser_data = testUtils.createMockUser();\r\n            const mockUserDoc = {\r\n                ...mockUser_data,\r\n                select: jest.fn().mockResolvedValue(mockUser_data)\r\n            };\r\n            mockUser.findById.mockReturnValue(mockUserDoc as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser(),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserById(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.json).toHaveBeenCalledWith({\r\n                message: \"Retrieving user successfully\",\r\n                user: mockUser_data\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserById(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 404 if user not found', async () => {\r\n            const mockUserDoc = {\r\n                select: jest.fn().mockResolvedValue(null)\r\n            };\r\n            mockUser.findById.mockReturnValue(mockUserDoc as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser(),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserById(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });\r\n        });\r\n\r\n        it('should return 403 if forbidden access', async () => {\r\n            const mockUser_data = testUtils.createMockUser({ email: 'different@email.com' });\r\n            const mockUserDoc = {\r\n                select: jest.fn().mockResolvedValue(mockUser_data)\r\n            };\r\n            mockUser.findById.mockReturnValue(mockUserDoc as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser({ _id: 'different-id', role: 'child' }),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserById(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(403);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });\r\n        });\r\n    });\r\n\r\n    // 3. test createUser API\r\n    describe('createUser', () => {\r\n        const validUserData = {\r\n            name: 'Test Child',\r\n            birthday: '2010-01-01',\r\n            gender: 'male',\r\n            role: 'child',\r\n            avatar: '/avatar.png',\r\n            interests: ['reading', 'sports']\r\n        };\r\n\r\n        it('should create user successfully', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent', email: 'parent@test.com' });\r\n            const mockFamilyData = testUtils.createMockFamily({ email: 'parent@test.com', members: [] });\r\n            const mockCreatedUser = testUtils.createMockUser(validUserData);\r\n\r\n            mockUser.findOne.mockResolvedValue(null); // No existing user\r\n            mockFamily.findOne.mockResolvedValue(mockFamilyData as any);\r\n            mockUser.create.mockResolvedValue(mockCreatedUser as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockParent,\r\n                body: validUserData\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUser.create).toHaveBeenCalled();\r\n            expect(mockEmailService.sendMail).toHaveBeenCalled();\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null, body: validUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 403 if user is child', async () => {\r\n            const mockChild = testUtils.createMockUser({ role: 'child' });\r\n            const mockReq = testUtils.createMockRequest({ user: mockChild, body: validUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(403);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });\r\n        });\r\n\r\n        it('should return 400 if required fields missing', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const incompleteData = { name: 'Test' }; // Missing required fields\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: incompleteData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'All required fields must be filled.' });\r\n        });\r\n\r\n        it('should return 409 if username already taken', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent', email: 'parent@test.com' });\r\n            const existingUser = testUtils.createMockUser({ name: 'Test Child', email: 'parent@test.com' });\r\n\r\n            mockUser.findOne.mockResolvedValue(existingUser as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: validUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(409);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'This username is already taken for this email.' });\r\n        });\r\n\r\n        it('should return 400 if interests is not array', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const invalidData = { ...validUserData, interests: 'not-an-array' };\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: invalidData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Interests must be an array.' });\r\n        });\r\n\r\n        it('should return 400 if invalid gender', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const invalidData = { ...validUserData, gender: 'invalid' };\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: invalidData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: \"Gender must be either 'male' or 'female'.\" });\r\n        });\r\n\r\n        it('should return 400 if invalid role', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const invalidData = { ...validUserData, role: 'invalid' };\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: invalidData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Invalid role.' });\r\n        });\r\n\r\n        it('should return 400 if invalid birthday', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const invalidData = { ...validUserData, birthday: 'invalid-date' };\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: invalidData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Invalid birthday format.' });\r\n        });\r\n\r\n        it('should return 404 if family not found', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            \r\n            mockUser.findOne.mockResolvedValue(null); // No existing user\r\n            mockFamily.findOne.mockResolvedValue(null); // No family found\r\n\r\n            const mockReq = testUtils.createMockRequest({ user: mockParent, body: validUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await createUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Family not found.' });\r\n        });\r\n    });\r\n\r\n\r\n    // 4. test editUserProfile API\r\n    describe('editUserProfile', () => {\r\n        it('should edit user profile successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            mockUser.findOne.mockResolvedValue(null); // No duplicate name\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    name: 'Updated Name',\r\n                    birthday: '1990-01-01',\r\n                    gender: 'male',\r\n                    avatar: '/new-avatar.png'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await editUserProfile(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"User profile updated successfully\",\r\n                user: expect.any(Object)\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await editUserProfile(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 403 if child tries to change role', async () => {\r\n            const mockChild = testUtils.createMockUser({ role: 'child' });\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockChild,\r\n                body: { role: 'parent' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await editUserProfile(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(403);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden: You cannot change role nor email' });\r\n        });\r\n\r\n        it('should return 404 if user not found', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            mockUser.findById.mockResolvedValue(null);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockParent,\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await editUserProfile(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });\r\n        });\r\n\r\n        it('should return 400 if name already exists', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const existingUser = testUtils.createMockUser({ name: 'Existing Name' });\r\n            \r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            mockUser.findOne.mockResolvedValue(existingUser as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    name: 'Existing Name'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await editUserProfile(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: 'A user with the same email and name already exists.' \r\n            });\r\n        });\r\n    });\r\n\r\n    // 5. test deleteUser API\r\n    describe('deleteUser', () => {\r\n        it('should delete user successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockFamilyData = testUtils.createMockFamily({ \r\n                members: [{ _id: '507f1f77bcf86cd799439011', role: 'child', name: 'Test', gender: 'male', avatar: '/avatar.png' }]\r\n            });\r\n\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            mockFamily.findById.mockResolvedValue(mockFamilyData as any);\r\n            mockUser.countDocuments.mockResolvedValue(2); // More than 1 parent\r\n            mockUser.findByIdAndDelete.mockResolvedValue(mockUserData as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await deleteUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUser.findByIdAndDelete).toHaveBeenCalledWith('507f1f77bcf86cd799439011');\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await deleteUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 400 if trying to delete last parent', async () => {\r\n            const mockParent = testUtils.createMockUser({ role: 'parent' });\r\n            const mockFamilyData = testUtils.createMockFamily();\r\n\r\n            mockUser.findById.mockResolvedValue(mockParent as any);\r\n            mockFamily.findById.mockResolvedValue(mockFamilyData as any);\r\n            mockUser.countDocuments.mockResolvedValue(1); // Only 1 parent\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockParent,\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await deleteUser(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: 'Cannot delete the last parent in the family' \r\n            });\r\n        });\r\n    });\r\n\r\n    // 6. test updatePassword API\r\n    describe('updatePassword', () => {\r\n        it('should update password successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            \r\n            (mockBcrypt.compare as jest.Mock)\r\n                .mockResolvedValueOnce(true)   // Old password matches\r\n                .mockResolvedValueOnce(false); // New password is different\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    oldPassword: 'oldPass123!',\r\n                    newPassword: 'NewPass123!',\r\n                    confirmPassword: 'NewPass123!'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updatePassword(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Password updated successfully.\",\r\n                password: 'NewPass123!'\r\n            });\r\n        });\r\n\r\n        it('should return 400 if old password incorrect', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            (mockBcrypt.compare as jest.Mock).mockResolvedValue(false);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    oldPassword: 'wrongPass',\r\n                    newPassword: 'NewPass123!',\r\n                    confirmPassword: 'NewPass123!'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updatePassword(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Old password is incorrect.' });\r\n        });\r\n\r\n        it('should return 400 if new password same as old', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            (mockBcrypt.compare as jest.Mock).mockResolvedValue(true);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    oldPassword: 'samePass123!',\r\n                    newPassword: 'samePass123!',\r\n                    confirmPassword: 'samePass123!'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updatePassword(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: 'New password cannot be the same as the old password.' \r\n            });\r\n        });\r\n\r\n        it('should return 400 if password does not meet requirements', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            mockUser.findById.mockResolvedValue(mockUserData as any);\r\n            \r\n            (mockBcrypt.compare as jest.Mock)\r\n                .mockResolvedValueOnce(true)   // Old password matches\r\n                .mockResolvedValueOnce(false); // New password is different\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    userId: '507f1f77bcf86cd799439011',\r\n                    oldPassword: 'oldPass123!',\r\n                    newPassword: 'weak', // Weak password\r\n                    confirmPassword: 'weak'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updatePassword(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: 'Password must be at least 8 characters long, include an uppercase letter, lowercase letter, a number, and a special character.' \r\n            });\r\n        });\r\n    });\r\n\r\n    // 7. test getUserStars API\r\n    describe('getUserStars', () => {\r\n        it('should get user stars successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ stars: 150 });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Stars retrieved successfully\",\r\n                stars: 150\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 8. test updateUserStars API\r\n    describe('updateUserStars', () => {\r\n        it('should update user stars successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100, \r\n                familyId: '507f1f77bcf86cd799439012' \r\n            });\r\n            mockFamily.findByIdAndUpdate.mockResolvedValue({} as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUserData.stars).toBe(150); // 100 + 50\r\n            expect(mockFamily.findByIdAndUpdate).toHaveBeenCalledWith(\r\n                '507f1f77bcf86cd799439012',\r\n                { $inc: { totalStars: 50 } }\r\n            );\r\n            expect(mockRecalculateFamilyMemberRanks.recalculateFamilyMemberRanks).toHaveBeenCalledWith(\r\n                '507f1f77bcf86cd799439012',\r\n                mockUserData\r\n            );\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"User stars updated successfully\",\r\n                user: mockUserData\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: null,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 400 if stars is undefined', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: {} // No stars field\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });\r\n        });\r\n\r\n        it('should return 400 if stars is not a number', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 'invalid' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });\r\n        });\r\n\r\n        it('should return 400 if stars is negative', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: -10 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });\r\n        });\r\n\r\n        it('should return 400 if user has no family id', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100,\r\n                familyId: null // No family ID\r\n            });\r\n            \r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUserData.stars).toBe(150); // Stars still get added\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'No family id' });\r\n        });\r\n\r\n        it('should handle zero stars correctly', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100, \r\n                familyId: '507f1f77bcf86cd799439012' \r\n            });\r\n            mockFamily.findByIdAndUpdate.mockResolvedValue({} as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 0 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUserData.stars).toBe(100); // 100 + 0 = 100\r\n            expect(mockFamily.findByIdAndUpdate).toHaveBeenCalledWith(\r\n                '507f1f77bcf86cd799439012',\r\n                { $inc: { totalStars: 0 } }\r\n            );\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n        });\r\n\r\n        it('should handle database error gracefully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100, \r\n                familyId: '507f1f77bcf86cd799439012' \r\n            });\r\n            // Mock save to throw an error\r\n            mockUserData.save = jest.fn().mockRejectedValue(new Error('Database error'));\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(500);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });\r\n        });\r\n\r\n        it('should handle family update error gracefully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100, \r\n                familyId: '507f1f77bcf86cd799439012' \r\n            });\r\n            // Mock family update to throw an error\r\n            mockFamily.findByIdAndUpdate.mockRejectedValue(new Error('Family update failed'));\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(500);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });\r\n        });\r\n\r\n        it('should handle rank recalculation error gracefully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                stars: 100, \r\n                familyId: '507f1f77bcf86cd799439012' \r\n            });\r\n            mockFamily.findByIdAndUpdate.mockResolvedValue({} as any);\r\n            // Mock rank recalculation to throw an error\r\n            mockRecalculateFamilyMemberRanks.recalculateFamilyMemberRanks.mockRejectedValue(\r\n                new Error('Rank calculation failed')\r\n            );\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { stars: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserStars(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(500);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });\r\n        });\r\n    });\r\n\r\n    // 9. test getUserCoins API\r\n    describe('getUserCoins', () => {\r\n        it('should get user coins successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ coins: 200 });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserCoins(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Coins retrieved successfully\",\r\n                coins: 200\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserCoins(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 10. test updateUserCoins API\r\n    describe('updateUserCoins', () => {\r\n        it('should update user coins successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ coins: 100 });\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { coins: 50 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserCoins(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUserData.coins).toBe(150);\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"User coins updated successfully\",\r\n                user: mockUserData\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserCoins(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 400 if coins is invalid', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { coins: 'invalid' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateUserCoins(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });\r\n        });\r\n    });\r\n\r\n    // 11. test getLocation API\r\n    describe('getLocation', () => {\r\n        it('should get user location successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ currentLocation: 'New York' });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Location retrieved successfully\",\r\n                location: 'New York'\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 12. test updateLocation API\r\n    describe('updateLocation', () => {\r\n        it('should update user location successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ currentLocation: 'Old Location' });\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { currentLocation: 'New Location' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockUserData.currentLocation).toBe('New Location');\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"User location updated successfully\",\r\n                user: mockUserData\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 400 if location is invalid', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { currentLocation: '' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Location must be valid.' });\r\n        });\r\n\r\n        it('should return 400 if location is not string', async () => {\r\n            const mockUserData = testUtils.createMockUser();\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { currentLocation: 123 }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await updateLocation(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Location must be valid.' });\r\n        });\r\n    });\r\n\r\n    // 13. test getUserRank API\r\n    describe('getUserRank', () => {\r\n        it('should get user rank successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ rankInFamily: 3 });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserRank(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Rank retrieved successfully\",\r\n                Rank: 3\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserRank(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 14. test getUserInterests API\r\n    describe('getUserInterests', () => {\r\n        it('should get user interests successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ interests: ['reading', 'sports'] });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserInterests(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Interests retrieved successfully\",\r\n                Interests: ['reading', 'sports']\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserInterests(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 15. test startAdventure API\r\n    describe('startAdventure', () => {\r\n        it('should start adventure successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ adventures: [] });\r\n            const mockAdventureData = testUtils.createMockAdventure();\r\n            \r\n            mockAdventure.findById.mockResolvedValue(mockAdventureData as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { adventureId: '507f1f77bcf86cd799439015' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await startAdventure(mockReq as any, mockRes as any);\r\n\r\n            expect(mockAdventure.findById).toHaveBeenCalledWith('507f1f77bcf86cd799439015');\r\n            expect(mockUserData.adventures).toHaveLength(1);\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"Adventure started successfully\",\r\n                user: mockUserData\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await startAdventure(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 404 if adventure not found', async () => {\r\n            const mockUserData = testUtils.createMockUser({ adventures: [] });\r\n            mockAdventure.findById.mockResolvedValue(null);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { adventureId: '507f1f77bcf86cd799439015' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await startAdventure(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure not found' });\r\n        });\r\n\r\n        it('should return 400 if adventure already started', async () => {\r\n            const existingAdventure = {\r\n                adventureId: { equals: jest.fn().mockReturnValue(true) },\r\n                challenges: [],\r\n                status: 'in-progress',\r\n                isAdventureCompleted: false,\r\n                starsReward: 100,\r\n                coinsReward: 50,\r\n                progress: 0\r\n            };\r\n            const mockUserData = testUtils.createMockUser({ adventures: [existingAdventure] });\r\n            const mockAdventureData = testUtils.createMockAdventure();\r\n            \r\n            mockAdventure.findById.mockResolvedValue(mockAdventureData as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { adventureId: '507f1f77bcf86cd799439015' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await startAdventure(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(400);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure already started' });\r\n        });\r\n    });\r\n\r\n    // 16. test completeChallenge API\r\n    describe('completeChallenge', () => {\r\n        it('should complete challenge successfully', async () => {\r\n            const mockChallenge = {\r\n                challengeId: { equals: jest.fn().mockReturnValue(true) },\r\n                isCompleted: false,\r\n                completedAt: undefined\r\n            };\r\n            const mockAdventureProgress = {\r\n                adventureId: { equals: jest.fn().mockReturnValue(true) },\r\n                challenges: [mockChallenge], \r\n                progress: 0,\r\n                isAdventureCompleted: false,\r\n                status: 'in-progress',\r\n                starsReward: 100, \r\n                coinsReward: 50  \r\n            };\r\n            const mockUserData = testUtils.createMockUser({ \r\n                adventures: [mockAdventureProgress],\r\n                stars: 100,\r\n                coins: 100,\r\n                familyId: '507f1f77bcf86cd799439012'\r\n            });\r\n            \r\n            const mockAdventureData = {\r\n                challenges: [{\r\n                    _id: { equals: jest.fn().mockReturnValue(true) },\r\n                    starsReward: 25,\r\n                    coinsReward: 15\r\n                }]\r\n            };\r\n            \r\n            mockAdventure.findById.mockReturnValue({\r\n                lean: jest.fn().mockResolvedValue(mockAdventureData)\r\n            } as any);\r\n            mockFamily.findByIdAndUpdate.mockResolvedValue({} as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    adventureId: '507f1f77bcf86cd799439015',\r\n                    challengeId: '507f1f77bcf86cd799439016'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockChallenge.isCompleted).toBe(true);\r\n            expect(mockChallenge.completedAt).toBeDefined();\r\n            \r\n            expect(mockUserData.stars).toBe(225);\r\n            expect(mockUserData.coins).toBe(165);\r\n            \r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n        });\r\n\r\n        it('should complete challenge without adventure completion bonus', async () => {\r\n            const mockChallenge1 = {\r\n                challengeId: { equals: jest.fn().mockReturnValue(true) },\r\n                isCompleted: false,\r\n                completedAt: undefined\r\n            };\r\n            const mockChallenge2 = {\r\n                challengeId: { equals: jest.fn().mockReturnValue(false) },\r\n                isCompleted: false,\r\n                completedAt: undefined\r\n            };\r\n            const mockAdventureProgress = {\r\n                adventureId: { equals: jest.fn().mockReturnValue(true) },\r\n                challenges: [mockChallenge1, mockChallenge2], \r\n                progress: 0,\r\n                isAdventureCompleted: false,\r\n                status: 'in-progress',\r\n                starsReward: 100,\r\n                coinsReward: 50\r\n            };\r\n            const mockUserData = testUtils.createMockUser({ \r\n                adventures: [mockAdventureProgress],\r\n                stars: 100,\r\n                coins: 100,\r\n                familyId: '507f1f77bcf86cd799439012'\r\n            });\r\n            \r\n            const mockAdventureData = {\r\n                challenges: [{\r\n                    _id: { equals: jest.fn().mockReturnValue(true) },\r\n                    starsReward: 25,\r\n                    coinsReward: 15\r\n                }]\r\n            };\r\n            \r\n            mockAdventure.findById.mockReturnValue({\r\n                lean: jest.fn().mockResolvedValue(mockAdventureData)\r\n            } as any);\r\n            mockFamily.findByIdAndUpdate.mockResolvedValue({} as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    adventureId: '507f1f77bcf86cd799439015',\r\n                    challengeId: '507f1f77bcf86cd799439016'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockChallenge1.isCompleted).toBe(true);\r\n            expect(mockAdventureProgress.progress).toBe(50); \r\n            expect(mockAdventureProgress.isAdventureCompleted).toBe(false);\r\n            \r\n            expect(mockUserData.stars).toBe(125);\r\n            expect(mockUserData.coins).toBe(115);\r\n            \r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 404 if adventure not found in user profile', async () => {\r\n            const mockUserData = testUtils.createMockUser({ adventures: [] });\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    adventureId: '507f1f77bcf86cd799439015',\r\n                    challengeId: '507f1f77bcf86cd799439016'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: \"Adventure not found in user's profile\" });\r\n        });\r\n\r\n        it('should return 404 if challenge not found in adventure', async () => {\r\n            const mockAdventureProgress = {\r\n                adventureId: { equals: jest.fn().mockReturnValue(true) },\r\n                challenges: [], // No challenges\r\n                progress: 0,\r\n                isAdventureCompleted: false,\r\n                status: 'in-progress',\r\n                starsReward: 100,\r\n                coinsReward: 50\r\n            };\r\n            const mockUserData = testUtils.createMockUser({ adventures: [mockAdventureProgress] });\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    adventureId: '507f1f77bcf86cd799439015',\r\n                    challengeId: '507f1f77bcf86cd799439016'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Challenge not found in adventure' });\r\n        });\r\n\r\n        it('should return 404 if adventure data not found', async () => {\r\n            const mockChallenge = {\r\n                challengeId: { equals: jest.fn().mockReturnValue(true) },\r\n                isCompleted: false\r\n            };\r\n            const mockAdventureProgress = {\r\n                adventureId: { equals: jest.fn().mockReturnValue(true) },\r\n                challenges: [mockChallenge],\r\n                progress: 0\r\n            };\r\n            const mockUserData = testUtils.createMockUser({ adventures: [mockAdventureProgress] });\r\n            \r\n            mockAdventure.findById.mockReturnValue({\r\n                lean: jest.fn().mockResolvedValue(null)\r\n            } as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData,\r\n                body: { \r\n                    adventureId: '507f1f77bcf86cd799439015',\r\n                    challengeId: '507f1f77bcf86cd799439016'\r\n                }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await completeChallenge(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure not found' });\r\n        });\r\n    });\r\n\r\n    // 17. test getUserAdventures API\r\n    describe('getUserAdventures', () => {\r\n        it('should get user adventures successfully', async () => {\r\n            const mockAdventures = [\r\n                { adventureId: '507f1f77bcf86cd799439015', status: 'in-progress' }\r\n            ];\r\n            const mockUserData = testUtils.createMockUser({ adventures: mockAdventures });\r\n            const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAdventures(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.send).toHaveBeenCalledWith({\r\n                message: \"User adventures retrieved successfully\",\r\n                Adventure: mockAdventures\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAdventures(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n    });\r\n\r\n    // 18. test getUserPurchasedItems API\r\n    describe('getUserPurchasedItems', () => {\r\n        it('should get user purchased items successfully', async () => {\r\n            const mockPurchasedItems = [\r\n                { itemId: '507f1f77bcf86cd799439020' },\r\n                { itemId: '507f1f77bcf86cd799439021' }\r\n            ];\r\n            const mockUserData = {\r\n                purchasedItems: mockPurchasedItems\r\n            };\r\n            const mockUserDoc = {\r\n                select: jest.fn().mockResolvedValue(mockUserData)\r\n            };\r\n            mockUser.findById.mockReturnValue(mockUserDoc as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser(),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserPurchasedItems(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.json).toHaveBeenCalledWith({\r\n                message: \"Purchased items retrieved successfully\",\r\n                purchasedItems: ['507f1f77bcf86cd799439020', '507f1f77bcf86cd799439021']\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserPurchasedItems(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });\r\n        });\r\n\r\n        it('should return 403 if trying to access other user items', async () => {\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser({ _id: 'different-user-id' }),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserPurchasedItems(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(403);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });\r\n        });\r\n\r\n        it('should return 404 if user not found', async () => {\r\n            const mockUserDoc = {\r\n                select: jest.fn().mockResolvedValue(null)\r\n            };\r\n            mockUser.findById.mockReturnValue(mockUserDoc as any);\r\n\r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: testUtils.createMockUser(),\r\n                body: { userId: '507f1f77bcf86cd799439011' }\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserPurchasedItems(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(404);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });\r\n        });\r\n    });\r\n\r\n    describe('getUserAvatar', () => {\r\n        it('should get user avatar successfully', async () => {\r\n            const mockUserData = testUtils.createMockUser({ \r\n                avatar: '/avatars/child-boy-1.png' \r\n            });\r\n            \r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData\r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.json).toHaveBeenCalledWith({\r\n                message: \"Avatar retrieved successfully\",\r\n                avatar: '/avatars/child-boy-1.png'\r\n            });\r\n        });\r\n\r\n        it('should return 401 if user not authenticated', async () => {\r\n            const mockReq = testUtils.createMockRequest({ user: null });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(401);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: \"Unauthorized\" \r\n            });\r\n        });\r\n\r\n        it('should handle different avatar formats correctly', async () => {\r\n            const testCases = [\r\n                { avatar: '/avatars/parent-woman.png', description: 'parent avatar' },\r\n                { avatar: '/avatars/child-girl-2.png', description: 'child avatar' },\r\n                { avatar: 'https://example.com/avatar.jpg', description: 'external URL' },\r\n                { avatar: '/default-avatar.svg', description: 'default avatar' },\r\n                { avatar: '', description: 'empty string' },\r\n                { avatar: null, description: 'null avatar' },\r\n                { avatar: undefined, description: 'undefined avatar' }\r\n            ];\r\n\r\n            for (const { avatar, description } of testCases) {\r\n                const mockUserData = testUtils.createMockUser({ avatar });\r\n                const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n                const mockRes = testUtils.createMockResponse();\r\n\r\n                await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n                expect(mockRes.status).toHaveBeenCalledWith(200);\r\n                expect(mockRes.json).toHaveBeenCalledWith({\r\n                    message: \"Avatar retrieved successfully\",\r\n                    avatar: avatar\r\n                });\r\n            }\r\n        });\r\n\r\n        it('should handle server errors gracefully', async () => {\r\n            // Create a normal user object first\r\n            const mockUserData = testUtils.createMockUser();\r\n            \r\n            // Then override the avatar property with a getter that throws\r\n            Object.defineProperty(mockUserData, 'avatar', {\r\n                get() {\r\n                    throw new Error('Database connection failed');\r\n                },\r\n                configurable: true\r\n            });\r\n            \r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: mockUserData \r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(500);\r\n            expect(mockRes.json).toHaveBeenCalledWith({ \r\n                error: \"Error fetching avatar\" \r\n            });\r\n        });\r\n\r\n\r\n        it('should handle user with all avatar edge cases', async () => {\r\n            // Test various edge cases for avatar property\r\n            const edgeCases = [\r\n                { avatar: 0, description: 'number zero' },\r\n                { avatar: false, description: 'boolean false' },\r\n                { avatar: [], description: 'empty array' },\r\n                { avatar: {}, description: 'empty object' },\r\n                { avatar: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==', description: 'base64 image' }\r\n            ];\r\n\r\n            for (const { avatar, description } of edgeCases) {\r\n                const mockUserData = testUtils.createMockUser({ avatar });\r\n                const mockReq = testUtils.createMockRequest({ user: mockUserData });\r\n                const mockRes = testUtils.createMockResponse();\r\n\r\n                await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n                expect(mockRes.status).toHaveBeenCalledWith(200);\r\n                expect(mockRes.json).toHaveBeenCalledWith({\r\n                    message: \"Avatar retrieved successfully\",\r\n                    avatar: avatar\r\n                });\r\n            }\r\n        });\r\n\r\n        it('should handle user object without avatar property', async () => {\r\n            // Create user without avatar property\r\n            const userWithoutAvatar = testUtils.createMockUser();\r\n            delete (userWithoutAvatar as any).avatar;\r\n            \r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: userWithoutAvatar \r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.json).toHaveBeenCalledWith({\r\n                message: \"Avatar retrieved successfully\",\r\n                avatar: undefined\r\n            });\r\n        });\r\n\r\n        it('should work with minimal user object', async () => {\r\n            // Test with very basic user object\r\n            const minimalUser = {\r\n                _id: '507f1f77bcf86cd799439011',\r\n                avatar: '/simple-avatar.png'\r\n            };\r\n            \r\n            const mockReq = testUtils.createMockRequest({ \r\n                user: minimalUser \r\n            });\r\n            const mockRes = testUtils.createMockResponse();\r\n\r\n            await getUserAvatar(mockReq as any, mockRes as any);\r\n\r\n            expect(mockRes.status).toHaveBeenCalledWith(200);\r\n            expect(mockRes.json).toHaveBeenCalledWith({\r\n                message: \"Avatar retrieved successfully\",\r\n                avatar: '/simple-avatar.png'\r\n            });\r\n        });\r\n    });\r\n});"],"names":["jest","mock","mockUser","User","mockAdventure","Adventure","mockFamily","Family","mockGenerateSecurePassword","generateSecurePassword","mockCheckId","checkId","mockEmailService","emailService","mockRecalculateFamilyMemberRanks","recalculateFamilyMemberRanks","mockBcrypt","bcrypt","describe","beforeEach","clearAllMocks","find","fn","findOne","findById","create","findByIdAndUpdate","findByIdAndDelete","countDocuments","mockReturnValue","spyOn","mockResolvedValue","undefined","it","mockUsers","testUtils","createMockUser","name","_id","mockReq","createMockRequest","mockRes","createMockResponse","getUsers","expect","toHaveBeenCalledTimes","status","toHaveBeenCalledWith","send","mockRejectedValue","Error","json","error","mockUser_data","mockUserDoc","select","user","body","userId","getUserById","message","email","role","validUserData","birthday","gender","avatar","interests","mockParent","mockFamilyData","createMockFamily","members","mockCreatedUser","createUser","toHaveBeenCalled","sendMail","mockChild","incompleteData","existingUser","invalidData","mockUserData","editUserProfile","any","Object","deleteUser","compare","mockResolvedValueOnce","oldPassword","newPassword","confirmPassword","updatePassword","password","stars","getUserStars","familyId","updateUserStars","toBe","$inc","totalStars","save","coins","getUserCoins","updateUserCoins","currentLocation","getLocation","location","updateLocation","rankInFamily","getUserRank","Rank","getUserInterests","Interests","adventures","mockAdventureData","createMockAdventure","adventureId","startAdventure","toHaveLength","existingAdventure","equals","challenges","isAdventureCompleted","starsReward","coinsReward","progress","mockChallenge","challengeId","isCompleted","completedAt","mockAdventureProgress","lean","completeChallenge","toBeDefined","mockChallenge1","mockChallenge2","mockAdventures","getUserAdventures","mockPurchasedItems","itemId","purchasedItems","getUserPurchasedItems","getUserAvatar","testCases","description","defineProperty","get","configurable","edgeCases","userWithoutAvatar","minimalUser"],"mappings":"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"}