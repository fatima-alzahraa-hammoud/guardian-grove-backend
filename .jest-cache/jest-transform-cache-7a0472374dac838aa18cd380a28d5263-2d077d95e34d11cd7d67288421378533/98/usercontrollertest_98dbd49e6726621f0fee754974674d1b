143363db683810813a50cfb0976d7b09
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock all dependencies
jest.mock('../../src/models/user.model');
jest.mock('../../src/models/adventure.model');
jest.mock('../../src/models/family.model');
jest.mock('../../src/services/email.service');
jest.mock('../../src/utils/generateSecurePassword');
jest.mock('../../src/utils/recalculateFamilyMemberRanks');
jest.mock('../../src/utils/checkId');
jest.mock('bcrypt');
const setup_1 = require("../setup");
const user_controller_1 = require("../../src/controllers/user.controller");
const user_model_1 = require("../../src/models/user.model");
const generateSecurePassword = __importStar(require("../../src/utils/generateSecurePassword"));
const checkId = __importStar(require("../../src/utils/checkId"));
const adventure_model_1 = require("../../src/models/adventure.model");
const family_model_1 = require("../../src/models/family.model");
const emailService = __importStar(require("../../src/services/email.service"));
const recalculateFamilyMemberRanks = __importStar(require("../../src/utils/recalculateFamilyMemberRanks"));
const bcrypt = __importStar(require("bcrypt"));
const mockUser = user_model_1.User;
const mockAdventure = adventure_model_1.Adventure;
const mockFamily = family_model_1.Family;
const mockGenerateSecurePassword = generateSecurePassword;
const mockCheckId = checkId;
const mockEmailService = emailService;
const mockRecalculateFamilyMemberRanks = recalculateFamilyMemberRanks;
const mockBcrypt = bcrypt;
describe('User Controller Tests', () => {
    beforeEach(() => {
        jest.clearAllMocks();
        // Setup User model methods
        mockUser.find = jest.fn();
        mockUser.findOne = jest.fn();
        mockUser.findById = jest.fn();
        mockUser.create = jest.fn();
        mockUser.findByIdAndUpdate = jest.fn();
        mockUser.findByIdAndDelete = jest.fn();
        mockUser.countDocuments = jest.fn();
        // Setup Adventure model methods
        mockAdventure.findById = jest.fn();
        // Setup Family model methods
        mockFamily.findOne = jest.fn();
        mockFamily.findById = jest.fn();
        mockFamily.findByIdAndUpdate = jest.fn();
        // Setup utility mocks
        mockGenerateSecurePassword.generateSecurePassword.mockReturnValue('TempPass123!');
        mockCheckId.checkId.mockReturnValue(true);
        jest.spyOn(mockEmailService, 'sendMail').mockResolvedValue(undefined);
        jest.spyOn(mockRecalculateFamilyMemberRanks, 'recalculateFamilyMemberRanks').mockResolvedValue(undefined);
        jest.spyOn(bcrypt, 'hash').mockResolvedValue('hashedPassword');
        jest.spyOn(bcrypt, 'compare').mockResolvedValue(true);
    });
    // 1. test getUsers API
    describe('getUsers', () => {
        it('should return all users successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUsers = [
                setup_1.testUtils.createMockUser({ name: 'John' }),
                setup_1.testUtils.createMockUser({ name: 'Jane', _id: '507f1f77bcf86cd799439013' })
            ];
            mockUser.find.mockResolvedValue(mockUsers);
            const mockReq = setup_1.testUtils.createMockRequest();
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUsers)(mockReq, mockRes);
            expect(mockUser.find).toHaveBeenCalledTimes(1);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith(mockUsers);
        }));
        it('should handle database errors', () => __awaiter(void 0, void 0, void 0, function* () {
            mockUser.find.mockRejectedValue(new Error('Database connection failed'));
            const mockReq = setup_1.testUtils.createMockRequest();
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUsers)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(500);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error retrieving users' });
        }));
    });
    // 2. test getUserById API
    describe('getUserById', () => {
        it('should return user by ID successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUser_data = setup_1.testUtils.createMockUser();
            const mockUserDoc = Object.assign(Object.assign({}, mockUser_data), { select: jest.fn().mockResolvedValue(mockUser_data) });
            mockUser.findById.mockReturnValue(mockUserDoc);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser(),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserById)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.json).toHaveBeenCalledWith({
                message: "Retrieving user successfully",
                user: mockUser_data
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserById)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 404 if user not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserDoc = {
                select: jest.fn().mockResolvedValue(null)
            };
            mockUser.findById.mockReturnValue(mockUserDoc);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser(),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserById)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });
        }));
        it('should return 403 if forbidden access', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUser_data = setup_1.testUtils.createMockUser({ email: 'different@email.com' });
            const mockUserDoc = {
                select: jest.fn().mockResolvedValue(mockUser_data)
            };
            mockUser.findById.mockReturnValue(mockUserDoc);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser({ _id: 'different-id', role: 'child' }),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserById)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(403);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });
        }));
    });
    // 3. test createUser API
    describe('createUser', () => {
        const validUserData = {
            name: 'Test Child',
            birthday: '2010-01-01',
            gender: 'male',
            role: 'child',
            avatar: '/avatar.png',
            interests: ['reading', 'sports']
        };
        it('should create user successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent', email: 'parent@test.com' });
            const mockFamilyData = setup_1.testUtils.createMockFamily({ email: 'parent@test.com', members: [] });
            const mockCreatedUser = setup_1.testUtils.createMockUser(validUserData);
            mockUser.findOne.mockResolvedValue(null); // No existing user
            mockFamily.findOne.mockResolvedValue(mockFamilyData);
            mockUser.create.mockResolvedValue(mockCreatedUser);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockParent,
                body: validUserData
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockUser.create).toHaveBeenCalled();
            expect(mockEmailService.sendMail).toHaveBeenCalled();
            expect(mockRes.status).toHaveBeenCalledWith(200);
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null, body: validUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 403 if user is child', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockChild = setup_1.testUtils.createMockUser({ role: 'child' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockChild, body: validUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(403);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });
        }));
        it('should return 400 if required fields missing', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const incompleteData = { name: 'Test' }; // Missing required fields
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: incompleteData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'All required fields must be filled.' });
        }));
        it('should return 409 if username already taken', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent', email: 'parent@test.com' });
            const existingUser = setup_1.testUtils.createMockUser({ name: 'Test Child', email: 'parent@test.com' });
            mockUser.findOne.mockResolvedValue(existingUser);
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: validUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(409);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'This username is already taken for this email.' });
        }));
        it('should return 400 if interests is not array', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const invalidData = Object.assign(Object.assign({}, validUserData), { interests: 'not-an-array' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: invalidData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Interests must be an array.' });
        }));
        it('should return 400 if invalid gender', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const invalidData = Object.assign(Object.assign({}, validUserData), { gender: 'invalid' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: invalidData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: "Gender must be either 'male' or 'female'." });
        }));
        it('should return 400 if invalid role', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const invalidData = Object.assign(Object.assign({}, validUserData), { role: 'invalid' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: invalidData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Invalid role.' });
        }));
        it('should return 400 if invalid birthday', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const invalidData = Object.assign(Object.assign({}, validUserData), { birthday: 'invalid-date' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: invalidData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Invalid birthday format.' });
        }));
        it('should return 404 if family not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            mockUser.findOne.mockResolvedValue(null); // No existing user
            mockFamily.findOne.mockResolvedValue(null); // No family found
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockParent, body: validUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.createUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Family not found.' });
        }));
    });
    // 4. test editUserProfile API
    describe('editUserProfile', () => {
        it('should edit user profile successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            mockUser.findById.mockResolvedValue(mockUserData);
            mockUser.findOne.mockResolvedValue(null); // No duplicate name
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    name: 'Updated Name',
                    birthday: '1990-01-01',
                    gender: 'male',
                    avatar: '/new-avatar.png'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.editUserProfile)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "User profile updated successfully",
                user: expect.any(Object)
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.editUserProfile)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 403 if child tries to change role', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockChild = setup_1.testUtils.createMockUser({ role: 'child' });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockChild,
                body: { role: 'parent' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.editUserProfile)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(403);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden: You cannot change role nor email' });
        }));
        it('should return 404 if user not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            mockUser.findById.mockResolvedValue(null);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockParent,
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.editUserProfile)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });
        }));
        it('should return 400 if name already exists', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const existingUser = setup_1.testUtils.createMockUser({ name: 'Existing Name' });
            mockUser.findById.mockResolvedValue(mockUserData);
            mockUser.findOne.mockResolvedValue(existingUser);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    name: 'Existing Name'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.editUserProfile)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: 'A user with the same email and name already exists.'
            });
        }));
    });
    // 5. test deleteUser API
    describe('deleteUser', () => {
        it('should delete user successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockFamilyData = setup_1.testUtils.createMockFamily({
                members: [{ _id: '507f1f77bcf86cd799439011', role: 'child', name: 'Test', gender: 'male', avatar: '/avatar.png' }]
            });
            mockUser.findById.mockResolvedValue(mockUserData);
            mockFamily.findById.mockResolvedValue(mockFamilyData);
            mockUser.countDocuments.mockResolvedValue(2); // More than 1 parent
            mockUser.findByIdAndDelete.mockResolvedValue(mockUserData);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.deleteUser)(mockReq, mockRes);
            expect(mockUser.findByIdAndDelete).toHaveBeenCalledWith('507f1f77bcf86cd799439011');
            expect(mockRes.status).toHaveBeenCalledWith(200);
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.deleteUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 400 if trying to delete last parent', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockParent = setup_1.testUtils.createMockUser({ role: 'parent' });
            const mockFamilyData = setup_1.testUtils.createMockFamily();
            mockUser.findById.mockResolvedValue(mockParent);
            mockFamily.findById.mockResolvedValue(mockFamilyData);
            mockUser.countDocuments.mockResolvedValue(1); // Only 1 parent
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockParent,
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.deleteUser)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: 'Cannot delete the last parent in the family'
            });
        }));
    });
    // 6. test updatePassword API
    describe('updatePassword', () => {
        it('should update password successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            mockUser.findById.mockResolvedValue(mockUserData);
            mockBcrypt.compare
                .mockResolvedValueOnce(true) // Old password matches
                .mockResolvedValueOnce(false); // New password is different
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    oldPassword: 'oldPass123!',
                    newPassword: 'NewPass123!',
                    confirmPassword: 'NewPass123!'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updatePassword)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Password updated successfully.",
                password: 'NewPass123!'
            });
        }));
        it('should return 400 if old password incorrect', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            mockUser.findById.mockResolvedValue(mockUserData);
            mockBcrypt.compare.mockResolvedValue(false);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    oldPassword: 'wrongPass',
                    newPassword: 'NewPass123!',
                    confirmPassword: 'NewPass123!'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updatePassword)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Old password is incorrect.' });
        }));
        it('should return 400 if new password same as old', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            mockUser.findById.mockResolvedValue(mockUserData);
            mockBcrypt.compare.mockResolvedValue(true);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    oldPassword: 'samePass123!',
                    newPassword: 'samePass123!',
                    confirmPassword: 'samePass123!'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updatePassword)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: 'New password cannot be the same as the old password.'
            });
        }));
        it('should return 400 if password does not meet requirements', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            mockUser.findById.mockResolvedValue(mockUserData);
            mockBcrypt.compare
                .mockResolvedValueOnce(true) // Old password matches
                .mockResolvedValueOnce(false); // New password is different
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    userId: '507f1f77bcf86cd799439011',
                    oldPassword: 'oldPass123!',
                    newPassword: 'weak', // Weak password
                    confirmPassword: 'weak'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updatePassword)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: 'Password must be at least 8 characters long, include an uppercase letter, lowercase letter, a number, and a special character.'
            });
        }));
    });
    // 7. test getUserStars API
    describe('getUserStars', () => {
        it('should get user stars successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ stars: 150 });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Stars retrieved successfully",
                stars: 150
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 8. test updateUserStars API
    describe('updateUserStars', () => {
        it('should update user stars successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            mockFamily.findByIdAndUpdate.mockResolvedValue({});
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockUserData.stars).toBe(150); // 100 + 50
            expect(mockFamily.findByIdAndUpdate).toHaveBeenCalledWith('507f1f77bcf86cd799439012', { $inc: { totalStars: 50 } });
            expect(mockRecalculateFamilyMemberRanks.recalculateFamilyMemberRanks).toHaveBeenCalledWith('507f1f77bcf86cd799439012', mockUserData);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "User stars updated successfully",
                user: mockUserData
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({
                user: null,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 400 if stars is undefined', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {} // No stars field
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });
        }));
        it('should return 400 if stars is not a number', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 'invalid' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });
        }));
        it('should return 400 if stars is negative', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: -10 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });
        }));
        it('should return 400 if user has no family id', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: null // No family ID
            });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockUserData.stars).toBe(150); // Stars still get added
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'No family id' });
        }));
        it('should handle zero stars correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            mockFamily.findByIdAndUpdate.mockResolvedValue({});
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 0 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockUserData.stars).toBe(100); // 100 + 0 = 100
            expect(mockFamily.findByIdAndUpdate).toHaveBeenCalledWith('507f1f77bcf86cd799439012', { $inc: { totalStars: 0 } });
            expect(mockRes.status).toHaveBeenCalledWith(200);
        }));
        it('should handle database error gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            // Mock save to throw an error
            mockUserData.save = jest.fn().mockRejectedValue(new Error('Database error'));
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(500);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });
        }));
        it('should handle family update error gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            // Mock family update to throw an error
            mockFamily.findByIdAndUpdate.mockRejectedValue(new Error('Family update failed'));
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(500);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });
        }));
        it('should handle rank recalculation error gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                stars: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            mockFamily.findByIdAndUpdate.mockResolvedValue({});
            // Mock rank recalculation to throw an error
            mockRecalculateFamilyMemberRanks.recalculateFamilyMemberRanks.mockRejectedValue(new Error('Rank calculation failed'));
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { stars: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserStars)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(500);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Error updating user stars' });
        }));
    });
    // 9. test getUserCoins API
    describe('getUserCoins', () => {
        it('should get user coins successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ coins: 200 });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserCoins)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Coins retrieved successfully",
                coins: 200
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserCoins)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 10. test updateUserCoins API
    describe('updateUserCoins', () => {
        it('should update user coins successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ coins: 100 });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { coins: 50 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserCoins)(mockReq, mockRes);
            expect(mockUserData.coins).toBe(150);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "User coins updated successfully",
                user: mockUserData
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserCoins)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 400 if coins is invalid', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { coins: 'invalid' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateUserCoins)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Stars must be a valid number.' });
        }));
    });
    // 11. test getLocation API
    describe('getLocation', () => {
        it('should get user location successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ currentLocation: 'New York' });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getLocation)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Location retrieved successfully",
                location: 'New York'
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getLocation)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 12. test updateLocation API
    describe('updateLocation', () => {
        it('should update user location successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ currentLocation: 'Old Location' });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { currentLocation: 'New Location' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateLocation)(mockReq, mockRes);
            expect(mockUserData.currentLocation).toBe('New Location');
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "User location updated successfully",
                user: mockUserData
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateLocation)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 400 if location is invalid', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { currentLocation: '' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateLocation)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Location must be valid.' });
        }));
        it('should return 400 if location is not string', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser();
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { currentLocation: 123 }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.updateLocation)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Location must be valid.' });
        }));
    });
    // 13. test getUserRank API
    describe('getUserRank', () => {
        it('should get user rank successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ rankInFamily: 3 });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserRank)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Rank retrieved successfully",
                Rank: 3
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserRank)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 14. test getUserInterests API
    describe('getUserInterests', () => {
        it('should get user interests successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ interests: ['reading', 'sports'] });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserInterests)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Interests retrieved successfully",
                Interests: ['reading', 'sports']
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserInterests)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 15. test startAdventure API
    describe('startAdventure', () => {
        it('should start adventure successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [] });
            const mockAdventureData = setup_1.testUtils.createMockAdventure();
            mockAdventure.findById.mockResolvedValue(mockAdventureData);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { adventureId: '507f1f77bcf86cd799439015' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.startAdventure)(mockReq, mockRes);
            expect(mockAdventure.findById).toHaveBeenCalledWith('507f1f77bcf86cd799439015');
            expect(mockUserData.adventures).toHaveLength(1);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "Adventure started successfully",
                user: mockUserData
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.startAdventure)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 404 if adventure not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [] });
            mockAdventure.findById.mockResolvedValue(null);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { adventureId: '507f1f77bcf86cd799439015' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.startAdventure)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure not found' });
        }));
        it('should return 400 if adventure already started', () => __awaiter(void 0, void 0, void 0, function* () {
            const existingAdventure = {
                adventureId: { equals: jest.fn().mockReturnValue(true) },
                challenges: [],
                status: 'in-progress',
                isAdventureCompleted: false,
                starsReward: 100,
                coinsReward: 50,
                progress: 0
            };
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [existingAdventure] });
            const mockAdventureData = setup_1.testUtils.createMockAdventure();
            mockAdventure.findById.mockResolvedValue(mockAdventureData);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: { adventureId: '507f1f77bcf86cd799439015' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.startAdventure)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(400);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure already started' });
        }));
    });
    // 16. test completeChallenge API
    describe('completeChallenge', () => {
        it('should complete challenge successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockChallenge = {
                challengeId: { equals: jest.fn().mockReturnValue(true) },
                isCompleted: false,
                completedAt: undefined
            };
            const mockAdventureProgress = {
                adventureId: { equals: jest.fn().mockReturnValue(true) },
                challenges: [mockChallenge],
                progress: 0,
                isAdventureCompleted: false,
                status: 'in-progress',
                starsReward: 100,
                coinsReward: 50
            };
            const mockUserData = setup_1.testUtils.createMockUser({
                adventures: [mockAdventureProgress],
                stars: 100,
                coins: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            const mockAdventureData = {
                challenges: [{
                        _id: { equals: jest.fn().mockReturnValue(true) },
                        starsReward: 25,
                        coinsReward: 15
                    }]
            };
            mockAdventure.findById.mockReturnValue({
                lean: jest.fn().mockResolvedValue(mockAdventureData)
            });
            mockFamily.findByIdAndUpdate.mockResolvedValue({});
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    adventureId: '507f1f77bcf86cd799439015',
                    challengeId: '507f1f77bcf86cd799439016'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockChallenge.isCompleted).toBe(true);
            expect(mockChallenge.completedAt).toBeDefined();
            expect(mockUserData.stars).toBe(225);
            expect(mockUserData.coins).toBe(165);
            expect(mockRes.status).toHaveBeenCalledWith(200);
        }));
        it('should complete challenge without adventure completion bonus', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockChallenge1 = {
                challengeId: { equals: jest.fn().mockReturnValue(true) },
                isCompleted: false,
                completedAt: undefined
            };
            const mockChallenge2 = {
                challengeId: { equals: jest.fn().mockReturnValue(false) },
                isCompleted: false,
                completedAt: undefined
            };
            const mockAdventureProgress = {
                adventureId: { equals: jest.fn().mockReturnValue(true) },
                challenges: [mockChallenge1, mockChallenge2],
                progress: 0,
                isAdventureCompleted: false,
                status: 'in-progress',
                starsReward: 100,
                coinsReward: 50
            };
            const mockUserData = setup_1.testUtils.createMockUser({
                adventures: [mockAdventureProgress],
                stars: 100,
                coins: 100,
                familyId: '507f1f77bcf86cd799439012'
            });
            const mockAdventureData = {
                challenges: [{
                        _id: { equals: jest.fn().mockReturnValue(true) },
                        starsReward: 25,
                        coinsReward: 15
                    }]
            };
            mockAdventure.findById.mockReturnValue({
                lean: jest.fn().mockResolvedValue(mockAdventureData)
            });
            mockFamily.findByIdAndUpdate.mockResolvedValue({});
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    adventureId: '507f1f77bcf86cd799439015',
                    challengeId: '507f1f77bcf86cd799439016'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockChallenge1.isCompleted).toBe(true);
            expect(mockAdventureProgress.progress).toBe(50);
            expect(mockAdventureProgress.isAdventureCompleted).toBe(false);
            expect(mockUserData.stars).toBe(125);
            expect(mockUserData.coins).toBe(115);
            expect(mockRes.status).toHaveBeenCalledWith(200);
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 404 if adventure not found in user profile', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [] });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    adventureId: '507f1f77bcf86cd799439015',
                    challengeId: '507f1f77bcf86cd799439016'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: "Adventure not found in user's profile" });
        }));
        it('should return 404 if challenge not found in adventure', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockAdventureProgress = {
                adventureId: { equals: jest.fn().mockReturnValue(true) },
                challenges: [], // No challenges
                progress: 0,
                isAdventureCompleted: false,
                status: 'in-progress',
                starsReward: 100,
                coinsReward: 50
            };
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [mockAdventureProgress] });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    adventureId: '507f1f77bcf86cd799439015',
                    challengeId: '507f1f77bcf86cd799439016'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Challenge not found in adventure' });
        }));
        it('should return 404 if adventure data not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockChallenge = {
                challengeId: { equals: jest.fn().mockReturnValue(true) },
                isCompleted: false
            };
            const mockAdventureProgress = {
                adventureId: { equals: jest.fn().mockReturnValue(true) },
                challenges: [mockChallenge],
                progress: 0
            };
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: [mockAdventureProgress] });
            mockAdventure.findById.mockReturnValue({
                lean: jest.fn().mockResolvedValue(null)
            });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData,
                body: {
                    adventureId: '507f1f77bcf86cd799439015',
                    challengeId: '507f1f77bcf86cd799439016'
                }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.completeChallenge)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Adventure not found' });
        }));
    });
    // 17. test getUserAdventures API
    describe('getUserAdventures', () => {
        it('should get user adventures successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockAdventures = [
                { adventureId: '507f1f77bcf86cd799439015', status: 'in-progress' }
            ];
            const mockUserData = setup_1.testUtils.createMockUser({ adventures: mockAdventures });
            const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAdventures)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.send).toHaveBeenCalledWith({
                message: "User adventures retrieved successfully",
                Adventure: mockAdventures
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAdventures)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
    });
    // 18. test getUserPurchasedItems API
    describe('getUserPurchasedItems', () => {
        it('should get user purchased items successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockPurchasedItems = [
                { itemId: '507f1f77bcf86cd799439020' },
                { itemId: '507f1f77bcf86cd799439021' }
            ];
            const mockUserData = {
                purchasedItems: mockPurchasedItems
            };
            const mockUserDoc = {
                select: jest.fn().mockResolvedValue(mockUserData)
            };
            mockUser.findById.mockReturnValue(mockUserDoc);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser(),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserPurchasedItems)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.json).toHaveBeenCalledWith({
                message: "Purchased items retrieved successfully",
                purchasedItems: ['507f1f77bcf86cd799439020', '507f1f77bcf86cd799439021']
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserPurchasedItems)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Unauthorized' });
        }));
        it('should return 403 if trying to access other user items', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser({ _id: 'different-user-id' }),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserPurchasedItems)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(403);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'Forbidden' });
        }));
        it('should return 404 if user not found', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserDoc = {
                select: jest.fn().mockResolvedValue(null)
            };
            mockUser.findById.mockReturnValue(mockUserDoc);
            const mockReq = setup_1.testUtils.createMockRequest({
                user: setup_1.testUtils.createMockUser(),
                body: { userId: '507f1f77bcf86cd799439011' }
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserPurchasedItems)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(404);
            expect(mockRes.json).toHaveBeenCalledWith({ error: 'User not found' });
        }));
    });
    describe('getUserAvatar', () => {
        it('should get user avatar successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockUserData = setup_1.testUtils.createMockUser({
                avatar: '/avatars/child-boy-1.png'
            });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.json).toHaveBeenCalledWith({
                message: "Avatar retrieved successfully",
                avatar: '/avatars/child-boy-1.png'
            });
        }));
        it('should return 401 if user not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            const mockReq = setup_1.testUtils.createMockRequest({ user: null });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(401);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: "Unauthorized"
            });
        }));
        it('should handle different avatar formats correctly', () => __awaiter(void 0, void 0, void 0, function* () {
            const testCases = [
                { avatar: '/avatars/parent-woman.png', description: 'parent avatar' },
                { avatar: '/avatars/child-girl-2.png', description: 'child avatar' },
                { avatar: 'https://example.com/avatar.jpg', description: 'external URL' },
                { avatar: '/default-avatar.svg', description: 'default avatar' },
                { avatar: '', description: 'empty string' },
                { avatar: null, description: 'null avatar' },
                { avatar: undefined, description: 'undefined avatar' }
            ];
            for (const { avatar, description } of testCases) {
                const mockUserData = setup_1.testUtils.createMockUser({ avatar });
                const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
                const mockRes = setup_1.testUtils.createMockResponse();
                yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
                expect(mockRes.status).toHaveBeenCalledWith(200);
                expect(mockRes.json).toHaveBeenCalledWith({
                    message: "Avatar retrieved successfully",
                    avatar: avatar
                });
            }
        }));
        it('should handle server errors gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Create a normal user object first
            const mockUserData = setup_1.testUtils.createMockUser();
            // Then override the avatar property with a getter that throws
            Object.defineProperty(mockUserData, 'avatar', {
                get() {
                    throw new Error('Database connection failed');
                },
                configurable: true
            });
            const mockReq = setup_1.testUtils.createMockRequest({
                user: mockUserData
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(500);
            expect(mockRes.json).toHaveBeenCalledWith({
                error: "Error fetching avatar"
            });
        }));
        it('should handle user with all avatar edge cases', () => __awaiter(void 0, void 0, void 0, function* () {
            // Test various edge cases for avatar property
            const edgeCases = [
                { avatar: 0, description: 'number zero' },
                { avatar: false, description: 'boolean false' },
                { avatar: [], description: 'empty array' },
                { avatar: {}, description: 'empty object' },
                { avatar: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==', description: 'base64 image' }
            ];
            for (const { avatar, description } of edgeCases) {
                const mockUserData = setup_1.testUtils.createMockUser({ avatar });
                const mockReq = setup_1.testUtils.createMockRequest({ user: mockUserData });
                const mockRes = setup_1.testUtils.createMockResponse();
                yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
                expect(mockRes.status).toHaveBeenCalledWith(200);
                expect(mockRes.json).toHaveBeenCalledWith({
                    message: "Avatar retrieved successfully",
                    avatar: avatar
                });
            }
        }));
        it('should handle user object without avatar property', () => __awaiter(void 0, void 0, void 0, function* () {
            // Create user without avatar property
            const userWithoutAvatar = setup_1.testUtils.createMockUser();
            delete userWithoutAvatar.avatar;
            const mockReq = setup_1.testUtils.createMockRequest({
                user: userWithoutAvatar
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.json).toHaveBeenCalledWith({
                message: "Avatar retrieved successfully",
                avatar: undefined
            });
        }));
        it('should work with minimal user object', () => __awaiter(void 0, void 0, void 0, function* () {
            // Test with very basic user object
            const minimalUser = {
                _id: '507f1f77bcf86cd799439011',
                avatar: '/simple-avatar.png'
            };
            const mockReq = setup_1.testUtils.createMockRequest({
                user: minimalUser
            });
            const mockRes = setup_1.testUtils.createMockResponse();
            yield (0, user_controller_1.getUserAvatar)(mockReq, mockRes);
            expect(mockRes.status).toHaveBeenCalledWith(200);
            expect(mockRes.json).toHaveBeenCalledWith({
                message: "Avatar retrieved successfully",
                avatar: '/simple-avatar.png'
            });
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxVU0VSXFxEZXNrdG9wXFxndWFyZGlhbi1ncm92ZVxcZ3VhcmRpYW4tZ3JvdmUtYmFja2VuZFxcdGVzdHNcXGNvbnRyb2xsZXJzXFx1c2VyLmNvbnRyb2xsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQSx3QkFBd0I7QUFDeEIsSUFBSSxDQUFDLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0FBQ3pDLElBQUksQ0FBQyxJQUFJLENBQUMsa0NBQWtDLENBQUMsQ0FBQztBQUM5QyxJQUFJLENBQUMsSUFBSSxDQUFDLCtCQUErQixDQUFDLENBQUM7QUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO0FBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsd0NBQXdDLENBQUMsQ0FBQztBQUNwRCxJQUFJLENBQUMsSUFBSSxDQUFDLDhDQUE4QyxDQUFDLENBQUM7QUFDMUQsSUFBSSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO0FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7QUF4QnBCLG9DQUFxQztBQUNyQywyRUFLK0M7QUFDL0MsNERBQW1EO0FBQ25ELCtGQUFpRjtBQUNqRixpRUFBbUQ7QUFDbkQsc0VBQTZEO0FBQzdELGdFQUF1RDtBQUN2RCwrRUFBaUU7QUFDakUsMkdBQTZGO0FBQzdGLCtDQUFpQztBQVlqQyxNQUFNLFFBQVEsR0FBRyxpQkFBZ0MsQ0FBQztBQUNsRCxNQUFNLGFBQWEsR0FBRywyQkFBMEMsQ0FBQztBQUNqRSxNQUFNLFVBQVUsR0FBRyxxQkFBb0MsQ0FBQztBQUN4RCxNQUFNLDBCQUEwQixHQUFHLHNCQUFvRSxDQUFDO0FBQ3hHLE1BQU0sV0FBVyxHQUFHLE9BQXNDLENBQUM7QUFDM0QsTUFBTSxnQkFBZ0IsR0FBRyxZQUFnRCxDQUFDO0FBQzFFLE1BQU0sZ0NBQWdDLEdBQUcsNEJBQWdGLENBQUM7QUFD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LE9BQWMsRUFBRSxPQUFjLENBQUMsQ0FBQztZQUVwRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3RDLE9BQU8sRUFBRSwrQkFBK0I7Z0JBQ3hDLE1BQU0sRUFBRSxvQkFBb0I7YUFDL0IsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxVU0VSXFxEZXNrdG9wXFxndWFyZGlhbi1ncm92ZVxcZ3VhcmRpYW4tZ3JvdmUtYmFja2VuZFxcdGVzdHNcXGNvbnRyb2xsZXJzXFx1c2VyLmNvbnRyb2xsZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0ZXN0VXRpbHMgfSBmcm9tICcuLi9zZXR1cCc7XHJcbmltcG9ydCB7ICBnZXRVc2VycywgZ2V0VXNlckJ5SWQsIGNyZWF0ZVVzZXIsIGVkaXRVc2VyUHJvZmlsZSxcclxuICAgIGRlbGV0ZVVzZXIsIHVwZGF0ZVBhc3N3b3JkLCBnZXRVc2VyU3RhcnMsIHVwZGF0ZVVzZXJTdGFycyxcclxuICAgIGdldFVzZXJDb2lucywgdXBkYXRlVXNlckNvaW5zLCBnZXRMb2NhdGlvbiwgdXBkYXRlTG9jYXRpb24sXHJcbiAgICBnZXRVc2VyUmFuaywgZ2V0VXNlckludGVyZXN0cywgc3RhcnRBZHZlbnR1cmUsIGNvbXBsZXRlQ2hhbGxlbmdlLFxyXG4gICAgZ2V0VXNlckFkdmVudHVyZXMsIGdldFVzZXJQdXJjaGFzZWRJdGVtcywgZ2V0VXNlckF2YXRhclxyXG59IGZyb20gJy4uLy4uL3NyYy9jb250cm9sbGVycy91c2VyLmNvbnRyb2xsZXInO1xyXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vc3JjL21vZGVscy91c2VyLm1vZGVsJztcclxuaW1wb3J0ICogYXMgZ2VuZXJhdGVTZWN1cmVQYXNzd29yZCBmcm9tICcuLi8uLi9zcmMvdXRpbHMvZ2VuZXJhdGVTZWN1cmVQYXNzd29yZCc7XHJcbmltcG9ydCAqIGFzIGNoZWNrSWQgZnJvbSAnLi4vLi4vc3JjL3V0aWxzL2NoZWNrSWQnO1xyXG5pbXBvcnQgeyBBZHZlbnR1cmUgfSBmcm9tICcuLi8uLi9zcmMvbW9kZWxzL2FkdmVudHVyZS5tb2RlbCc7XHJcbmltcG9ydCB7IEZhbWlseSB9IGZyb20gJy4uLy4uL3NyYy9tb2RlbHMvZmFtaWx5Lm1vZGVsJztcclxuaW1wb3J0ICogYXMgZW1haWxTZXJ2aWNlIGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy9lbWFpbC5zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgcmVjYWxjdWxhdGVGYW1pbHlNZW1iZXJSYW5rcyBmcm9tICcuLi8uLi9zcmMvdXRpbHMvcmVjYWxjdWxhdGVGYW1pbHlNZW1iZXJSYW5rcyc7XHJcbmltcG9ydCAqIGFzIGJjcnlwdCBmcm9tICdiY3J5cHQnO1xyXG5cclxuLy8gTW9jayBhbGwgZGVwZW5kZW5jaWVzXHJcbmplc3QubW9jaygnLi4vLi4vc3JjL21vZGVscy91c2VyLm1vZGVsJyk7XHJcbmplc3QubW9jaygnLi4vLi4vc3JjL21vZGVscy9hZHZlbnR1cmUubW9kZWwnKTtcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvbW9kZWxzL2ZhbWlseS5tb2RlbCcpO1xyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy9zZXJ2aWNlcy9lbWFpbC5zZXJ2aWNlJyk7XHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3V0aWxzL2dlbmVyYXRlU2VjdXJlUGFzc3dvcmQnKTtcclxuamVzdC5tb2NrKCcuLi8uLi9zcmMvdXRpbHMvcmVjYWxjdWxhdGVGYW1pbHlNZW1iZXJSYW5rcycpO1xyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy91dGlscy9jaGVja0lkJyk7XHJcbmplc3QubW9jaygnYmNyeXB0Jyk7XHJcblxyXG5jb25zdCBtb2NrVXNlciA9IFVzZXIgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIFVzZXI+O1xyXG5jb25zdCBtb2NrQWR2ZW50dXJlID0gQWR2ZW50dXJlIGFzIGplc3QuTW9ja2VkPHR5cGVvZiBBZHZlbnR1cmU+O1xyXG5jb25zdCBtb2NrRmFtaWx5ID0gRmFtaWx5IGFzIGplc3QuTW9ja2VkPHR5cGVvZiBGYW1pbHk+O1xyXG5jb25zdCBtb2NrR2VuZXJhdGVTZWN1cmVQYXNzd29yZCA9IGdlbmVyYXRlU2VjdXJlUGFzc3dvcmQgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGdlbmVyYXRlU2VjdXJlUGFzc3dvcmQ+O1xyXG5jb25zdCBtb2NrQ2hlY2tJZCA9IGNoZWNrSWQgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGNoZWNrSWQ+O1xyXG5jb25zdCBtb2NrRW1haWxTZXJ2aWNlID0gZW1haWxTZXJ2aWNlIGFzIGplc3QuTW9ja2VkPHR5cGVvZiBlbWFpbFNlcnZpY2U+O1xyXG5jb25zdCBtb2NrUmVjYWxjdWxhdGVGYW1pbHlNZW1iZXJSYW5rcyA9IHJlY2FsY3VsYXRlRmFtaWx5TWVtYmVyUmFua3MgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIHJlY2FsY3VsYXRlRmFtaWx5TWVtYmVyUmFua3M+O1xyXG5jb25zdCBtb2NrQmNyeXB0ID0gYmNyeXB0IGFzIGplc3QuTW9ja2VkPHR5cGVvZiBiY3J5cHQ+O1xyXG5cclxuZGVzY3JpYmUoJ1VzZXIgQ29udHJvbGxlciBUZXN0cycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNldHVwIFVzZXIgbW9kZWwgbWV0aG9kc1xyXG4gICAgICAgIG1vY2tVc2VyLmZpbmQgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgbW9ja1VzZXIuZmluZE9uZSA9IGplc3QuZm4oKTtcclxuICAgICAgICBtb2NrVXNlci5maW5kQnlJZCA9IGplc3QuZm4oKTtcclxuICAgICAgICBtb2NrVXNlci5jcmVhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWRBbmRVcGRhdGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWRBbmREZWxldGUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgbW9ja1VzZXIuY291bnREb2N1bWVudHMgPSBqZXN0LmZuKCk7XHJcblxyXG4gICAgICAgIC8vIFNldHVwIEFkdmVudHVyZSBtb2RlbCBtZXRob2RzXHJcbiAgICAgICAgbW9ja0FkdmVudHVyZS5maW5kQnlJZCA9IGplc3QuZm4oKTtcclxuXHJcbiAgICAgICAgLy8gU2V0dXAgRmFtaWx5IG1vZGVsIG1ldGhvZHNcclxuICAgICAgICBtb2NrRmFtaWx5LmZpbmRPbmUgPSBqZXN0LmZuKCk7XHJcbiAgICAgICAgbW9ja0ZhbWlseS5maW5kQnlJZCA9IGplc3QuZm4oKTtcclxuICAgICAgICBtb2NrRmFtaWx5LmZpbmRCeUlkQW5kVXBkYXRlID0gamVzdC5mbigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNldHVwIHV0aWxpdHkgbW9ja3NcclxuICAgICAgICBtb2NrR2VuZXJhdGVTZWN1cmVQYXNzd29yZC5nZW5lcmF0ZVNlY3VyZVBhc3N3b3JkLm1vY2tSZXR1cm5WYWx1ZSgnVGVtcFBhc3MxMjMhJyk7XHJcbiAgICAgICAgbW9ja0NoZWNrSWQuY2hlY2tJZC5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XHJcbiAgICAgICAgamVzdC5zcHlPbihtb2NrRW1haWxTZXJ2aWNlLCAnc2VuZE1haWwnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgIGplc3Quc3B5T24obW9ja1JlY2FsY3VsYXRlRmFtaWx5TWVtYmVyUmFua3MsICdyZWNhbGN1bGF0ZUZhbWlseU1lbWJlclJhbmtzJykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuICAgICAgICBcclxuICAgICAgICAoamVzdC5zcHlPbihiY3J5cHQsICdoYXNoJykgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnaGFzaGVkUGFzc3dvcmQnKTtcclxuICAgICAgICAoamVzdC5zcHlPbihiY3J5cHQsICdjb21wYXJlJykgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDEuIHRlc3QgZ2V0VXNlcnMgQVBJXHJcbiAgICBkZXNjcmliZSgnZ2V0VXNlcnMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHVzZXJzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJzID0gW1xyXG4gICAgICAgICAgICAgICAgdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgbmFtZTogJ0pvaG4nIH0pLFxyXG4gICAgICAgICAgICAgICAgdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgbmFtZTogJ0phbmUnLCBfaWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTMnIH0pXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRVc2Vycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyLmZpbmQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zZW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrVXNlcnMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmQubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDUwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdFcnJvciByZXRyaWV2aW5nIHVzZXJzJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDIuIHRlc3QgZ2V0VXNlckJ5SWQgQVBJXHJcbiAgICBkZXNjcmliZSgnZ2V0VXNlckJ5SWQnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdXNlciBieSBJRCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyX2RhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEb2MgPSB7XHJcbiAgICAgICAgICAgICAgICAuLi5tb2NrVXNlcl9kYXRhLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJfZGF0YSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1JldHVyblZhbHVlKG1vY2tVc2VyRG9jIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckJ5SWQobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJSZXRyaWV2aW5nIHVzZXIgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlcl9kYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRVc2VyQnlJZChtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGlmIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRvYyA9IHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmRCeUlkLm1vY2tSZXR1cm5WYWx1ZShtb2NrVXNlckRvYyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCksXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJCeUlkKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwNCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMyBpZiBmb3JiaWRkZW4gYWNjZXNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlcl9kYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgZW1haWw6ICdkaWZmZXJlbnRAZW1haWwuY29tJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEb2MgPSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcl9kYXRhKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kQnlJZC5tb2NrUmV0dXJuVmFsdWUobW9ja1VzZXJEb2MgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IF9pZDogJ2RpZmZlcmVudC1pZCcsIHJvbGU6ICdjaGlsZCcgfSksXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJCeUlkKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdGb3JiaWRkZW4nIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMy4gdGVzdCBjcmVhdGVVc2VyIEFQSVxyXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZVVzZXInLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsaWRVc2VyRGF0YSA9IHtcclxuICAgICAgICAgICAgbmFtZTogJ1Rlc3QgQ2hpbGQnLFxyXG4gICAgICAgICAgICBiaXJ0aGRheTogJzIwMTAtMDEtMDEnLFxyXG4gICAgICAgICAgICBnZW5kZXI6ICdtYWxlJyxcclxuICAgICAgICAgICAgcm9sZTogJ2NoaWxkJyxcclxuICAgICAgICAgICAgYXZhdGFyOiAnL2F2YXRhci5wbmcnLFxyXG4gICAgICAgICAgICBpbnRlcmVzdHM6IFsncmVhZGluZycsICdzcG9ydHMnXVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHVzZXIgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUGFyZW50ID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcm9sZTogJ3BhcmVudCcsIGVtYWlsOiAncGFyZW50QHRlc3QuY29tJyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZhbWlseURhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja0ZhbWlseSh7IGVtYWlsOiAncGFyZW50QHRlc3QuY29tJywgbWVtYmVyczogW10gfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tDcmVhdGVkVXNlciA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih2YWxpZFVzZXJEYXRhKTtcclxuXHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7IC8vIE5vIGV4aXN0aW5nIHVzZXJcclxuICAgICAgICAgICAgbW9ja0ZhbWlseS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tGYW1pbHlEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmNyZWF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ3JlYXRlZFVzZXIgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tQYXJlbnQsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB2YWxpZFVzZXJEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY3JlYXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyLmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja0VtYWlsU2VydmljZS5zZW5kTWFpbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbnVsbCwgYm9keTogdmFsaWRVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVVzZXIobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMyBpZiB1c2VyIGlzIGNoaWxkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQ2hpbGQgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyByb2xlOiAnY2hpbGQnIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja0NoaWxkLCBib2R5OiB2YWxpZFVzZXJEYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY3JlYXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDMpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnRm9yYmlkZGVuJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIHJlcXVpcmVkIGZpZWxkcyBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUGFyZW50ID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcm9sZTogJ3BhcmVudCcgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGluY29tcGxldGVEYXRhID0geyBuYW1lOiAnVGVzdCcgfTsgLy8gTWlzc2luZyByZXF1aXJlZCBmaWVsZHNcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBtb2NrUGFyZW50LCBib2R5OiBpbmNvbXBsZXRlRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVVzZXIobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0FsbCByZXF1aXJlZCBmaWVsZHMgbXVzdCBiZSBmaWxsZWQuJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA5IGlmIHVzZXJuYW1lIGFscmVhZHkgdGFrZW4nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tQYXJlbnQgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyByb2xlOiAncGFyZW50JywgZW1haWw6ICdwYXJlbnRAdGVzdC5jb20nIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBuYW1lOiAnVGVzdCBDaGlsZCcsIGVtYWlsOiAncGFyZW50QHRlc3QuY29tJyB9KTtcclxuXHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUoZXhpc3RpbmdVc2VyIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja1BhcmVudCwgYm9keTogdmFsaWRVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVVzZXIobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDA5KTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ1RoaXMgdXNlcm5hbWUgaXMgYWxyZWFkeSB0YWtlbiBmb3IgdGhpcyBlbWFpbC4nIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgaWYgaW50ZXJlc3RzIGlzIG5vdCBhcnJheScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1BhcmVudCA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IHJvbGU6ICdwYXJlbnQnIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBpbnZhbGlkRGF0YSA9IHsgLi4udmFsaWRVc2VyRGF0YSwgaW50ZXJlc3RzOiAnbm90LWFuLWFycmF5JyB9O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tQYXJlbnQsIGJvZHk6IGludmFsaWREYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY3JlYXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnSW50ZXJlc3RzIG11c3QgYmUgYW4gYXJyYXkuJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIGludmFsaWQgZ2VuZGVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUGFyZW50ID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcm9sZTogJ3BhcmVudCcgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGludmFsaWREYXRhID0geyAuLi52YWxpZFVzZXJEYXRhLCBnZW5kZXI6ICdpbnZhbGlkJyB9O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tQYXJlbnQsIGJvZHk6IGludmFsaWREYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY3JlYXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiBcIkdlbmRlciBtdXN0IGJlIGVpdGhlciAnbWFsZScgb3IgJ2ZlbWFsZScuXCIgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBpbnZhbGlkIHJvbGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tQYXJlbnQgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyByb2xlOiAncGFyZW50JyB9KTtcclxuICAgICAgICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7IC4uLnZhbGlkVXNlckRhdGEsIHJvbGU6ICdpbnZhbGlkJyB9O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tQYXJlbnQsIGJvZHk6IGludmFsaWREYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY3JlYXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnSW52YWxpZCByb2xlLicgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBpbnZhbGlkIGJpcnRoZGF5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUGFyZW50ID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcm9sZTogJ3BhcmVudCcgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGludmFsaWREYXRhID0geyAuLi52YWxpZFVzZXJEYXRhLCBiaXJ0aGRheTogJ2ludmFsaWQtZGF0ZScgfTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBtb2NrUGFyZW50LCBib2R5OiBpbnZhbGlkRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVVzZXIobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0ludmFsaWQgYmlydGhkYXkgZm9ybWF0LicgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwNCBpZiBmYW1pbHkgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUGFyZW50ID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcm9sZTogJ3BhcmVudCcgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpOyAvLyBObyBleGlzdGluZyB1c2VyXHJcbiAgICAgICAgICAgIG1vY2tGYW1pbHkuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTsgLy8gTm8gZmFtaWx5IGZvdW5kXHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja1BhcmVudCwgYm9keTogdmFsaWRVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVVzZXIobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDA0KTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0ZhbWlseSBub3QgZm91bmQuJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyA0LiB0ZXN0IGVkaXRVc2VyUHJvZmlsZSBBUElcclxuICAgIGRlc2NyaWJlKCdlZGl0VXNlclByb2ZpbGUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBlZGl0IHVzZXIgcHJvZmlsZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlckRhdGEgYXMgYW55KTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTsgLy8gTm8gZHVwbGljYXRlIG5hbWVcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnVXBkYXRlZCBOYW1lJyxcclxuICAgICAgICAgICAgICAgICAgICBiaXJ0aGRheTogJzE5OTAtMDEtMDEnLFxyXG4gICAgICAgICAgICAgICAgICAgIGdlbmRlcjogJ21hbGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGF2YXRhcjogJy9uZXctYXZhdGFyLnBuZydcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBlZGl0VXNlclByb2ZpbGUobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc2VuZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIHByb2ZpbGUgdXBkYXRlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIHVzZXI6IGV4cGVjdC5hbnkoT2JqZWN0KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGlmIHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBudWxsIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZWRpdFVzZXJQcm9maWxlKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDMgaWYgY2hpbGQgdHJpZXMgdG8gY2hhbmdlIHJvbGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tDaGlsZCA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IHJvbGU6ICdjaGlsZCcgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tDaGlsZCxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgcm9sZTogJ3BhcmVudCcgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGVkaXRVc2VyUHJvZmlsZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDMpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnRm9yYmlkZGVuOiBZb3UgY2Fubm90IGNoYW5nZSByb2xlIG5vciBlbWFpbCcgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwNCBpZiB1c2VyIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1BhcmVudCA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IHJvbGU6ICdwYXJlbnQnIH0pO1xyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tQYXJlbnQsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGVkaXRVc2VyUHJvZmlsZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVXNlciBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgaWYgbmFtZSBhbHJlYWR5IGV4aXN0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IG5hbWU6ICdFeGlzdGluZyBOYW1lJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyRGF0YSBhcyBhbnkpO1xyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKGV4aXN0aW5nVXNlciBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTEnLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFeGlzdGluZyBOYW1lJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGVkaXRVc2VyUHJvZmlsZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdBIHVzZXIgd2l0aCB0aGUgc2FtZSBlbWFpbCBhbmQgbmFtZSBhbHJlYWR5IGV4aXN0cy4nIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDUuIHRlc3QgZGVsZXRlVXNlciBBUElcclxuICAgIGRlc2NyaWJlKCdkZWxldGVVc2VyJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZGVsZXRlIHVzZXIgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZhbWlseURhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja0ZhbWlseSh7IFxyXG4gICAgICAgICAgICAgICAgbWVtYmVyczogW3sgX2lkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJywgcm9sZTogJ2NoaWxkJywgbmFtZTogJ1Rlc3QnLCBnZW5kZXI6ICdtYWxlJywgYXZhdGFyOiAnL2F2YXRhci5wbmcnIH1dXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIG1vY2tGYW1pbHkuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZhbWlseURhdGEgYXMgYW55KTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuY291bnREb2N1bWVudHMubW9ja1Jlc29sdmVkVmFsdWUoMik7IC8vIE1vcmUgdGhhbiAxIHBhcmVudFxyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kQnlJZEFuZERlbGV0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlckRhdGEgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZGVsZXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyLmZpbmRCeUlkQW5kRGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGlmIHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBudWxsIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZGVsZXRlVXNlcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIHRyeWluZyB0byBkZWxldGUgbGFzdCBwYXJlbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tQYXJlbnQgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyByb2xlOiAncGFyZW50JyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0ZhbWlseURhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja0ZhbWlseSgpO1xyXG5cclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhcmVudCBhcyBhbnkpO1xyXG4gICAgICAgICAgICBtb2NrRmFtaWx5LmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tGYW1pbHlEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmNvdW50RG9jdW1lbnRzLm1vY2tSZXNvbHZlZFZhbHVlKDEpOyAvLyBPbmx5IDEgcGFyZW50XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrUGFyZW50LFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyB1c2VySWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTEnIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBkZWxldGVVc2VyKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgdGhlIGxhc3QgcGFyZW50IGluIHRoZSBmYW1pbHknIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDYuIHRlc3QgdXBkYXRlUGFzc3dvcmQgQVBJXHJcbiAgICBkZXNjcmliZSgndXBkYXRlUGFzc3dvcmQnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUgcGFzc3dvcmQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAobW9ja0JjcnlwdC5jb21wYXJlIGFzIGplc3QuTW9jaylcclxuICAgICAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UodHJ1ZSkgICAvLyBPbGQgcGFzc3dvcmQgbWF0Y2hlc1xyXG4gICAgICAgICAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShmYWxzZSk7IC8vIE5ldyBwYXNzd29yZCBpcyBkaWZmZXJlbnRcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyxcclxuICAgICAgICAgICAgICAgICAgICBvbGRQYXNzd29yZDogJ29sZFBhc3MxMjMhJyxcclxuICAgICAgICAgICAgICAgICAgICBuZXdQYXNzd29yZDogJ05ld1Bhc3MxMjMhJyxcclxuICAgICAgICAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICdOZXdQYXNzMTIzISdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVQYXNzd29yZChtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zZW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIlBhc3N3b3JkIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LlwiLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICdOZXdQYXNzMTIzISdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBvbGQgcGFzc3dvcmQgaW5jb3JyZWN0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIChtb2NrQmNyeXB0LmNvbXBhcmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScsXHJcbiAgICAgICAgICAgICAgICAgICAgb2xkUGFzc3dvcmQ6ICd3cm9uZ1Bhc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiAnTmV3UGFzczEyMyEnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpcm1QYXNzd29yZDogJ05ld1Bhc3MxMjMhJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVBhc3N3b3JkKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdPbGQgcGFzc3dvcmQgaXMgaW5jb3JyZWN0LicgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBuZXcgcGFzc3dvcmQgc2FtZSBhcyBvbGQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBtb2NrVXNlci5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlckRhdGEgYXMgYW55KTtcclxuICAgICAgICAgICAgKG1vY2tCY3J5cHQuY29tcGFyZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTEnLFxyXG4gICAgICAgICAgICAgICAgICAgIG9sZFBhc3N3b3JkOiAnc2FtZVBhc3MxMjMhJyxcclxuICAgICAgICAgICAgICAgICAgICBuZXdQYXNzd29yZDogJ3NhbWVQYXNzMTIzIScsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlybVBhc3N3b3JkOiAnc2FtZVBhc3MxMjMhJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVBhc3N3b3JkKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05ldyBwYXNzd29yZCBjYW5ub3QgYmUgdGhlIHNhbWUgYXMgdGhlIG9sZCBwYXNzd29yZC4nIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIHBhc3N3b3JkIGRvZXMgbm90IG1lZXQgcmVxdWlyZW1lbnRzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJEYXRhIGFzIGFueSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAobW9ja0JjcnlwdC5jb21wYXJlIGFzIGplc3QuTW9jaylcclxuICAgICAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UodHJ1ZSkgICAvLyBPbGQgcGFzc3dvcmQgbWF0Y2hlc1xyXG4gICAgICAgICAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShmYWxzZSk7IC8vIE5ldyBwYXNzd29yZCBpcyBkaWZmZXJlbnRcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyxcclxuICAgICAgICAgICAgICAgICAgICBvbGRQYXNzd29yZDogJ29sZFBhc3MxMjMhJyxcclxuICAgICAgICAgICAgICAgICAgICBuZXdQYXNzd29yZDogJ3dlYWsnLCAvLyBXZWFrIHBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlybVBhc3N3b3JkOiAnd2VhaydcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVQYXNzd29yZChtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nLCBpbmNsdWRlIGFuIHVwcGVyY2FzZSBsZXR0ZXIsIGxvd2VyY2FzZSBsZXR0ZXIsIGEgbnVtYmVyLCBhbmQgYSBzcGVjaWFsIGNoYXJhY3Rlci4nIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDcuIHRlc3QgZ2V0VXNlclN0YXJzIEFQSVxyXG4gICAgZGVzY3JpYmUoJ2dldFVzZXJTdGFycycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGdldCB1c2VyIHN0YXJzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgc3RhcnM6IDE1MCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zZW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIlN0YXJzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIHN0YXJzOiAxNTBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbnVsbCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDguIHRlc3QgdXBkYXRlVXNlclN0YXJzIEFQSVxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZVVzZXJTdGFycycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB1c2VyIHN0YXJzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgXHJcbiAgICAgICAgICAgICAgICBzdGFyczogMTAwLCBcclxuICAgICAgICAgICAgICAgIGZhbWlseUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDEyJyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG1vY2tGYW1pbHkuZmluZEJ5SWRBbmRVcGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgc3RhcnM6IDUwIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVVc2VyU3RhcnMobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXNlckRhdGEuc3RhcnMpLnRvQmUoMTUwKTsgLy8gMTAwICsgNTBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tGYW1pbHkuZmluZEJ5SWRBbmRVcGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgICAgICAgICAgJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMicsXHJcbiAgICAgICAgICAgICAgICB7ICRpbmM6IHsgdG90YWxTdGFyczogNTAgfSB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVjYWxjdWxhdGVGYW1pbHlNZW1iZXJSYW5rcy5yZWNhbGN1bGF0ZUZhbWlseU1lbWJlclJhbmtzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgICAgICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTInLFxyXG4gICAgICAgICAgICAgICAgbW9ja1VzZXJEYXRhXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc2VuZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIHN0YXJzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBzdGFyczogNTAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIHN0YXJzIGlzIHVuZGVmaW5lZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHt9IC8vIE5vIHN0YXJzIGZpZWxkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlVXNlclN0YXJzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdTdGFycyBtdXN0IGJlIGEgdmFsaWQgbnVtYmVyLicgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBzdGFycyBpcyBub3QgYSBudW1iZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHN0YXJzOiAnaW52YWxpZCcgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnU3RhcnMgbXVzdCBiZSBhIHZhbGlkIG51bWJlci4nIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgaWYgc3RhcnMgaXMgbmVnYXRpdmUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHN0YXJzOiAtMTAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnU3RhcnMgbXVzdCBiZSBhIHZhbGlkIG51bWJlci4nIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgaWYgdXNlciBoYXMgbm8gZmFtaWx5IGlkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBcclxuICAgICAgICAgICAgICAgIHN0YXJzOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBmYW1pbHlJZDogbnVsbCAvLyBObyBmYW1pbHkgSURcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHN0YXJzOiA1MCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlVXNlclN0YXJzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VzZXJEYXRhLnN0YXJzKS50b0JlKDE1MCk7IC8vIFN0YXJzIHN0aWxsIGdldCBhZGRlZFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdObyBmYW1pbHkgaWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB6ZXJvIHN0YXJzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgXHJcbiAgICAgICAgICAgICAgICBzdGFyczogMTAwLCBcclxuICAgICAgICAgICAgICAgIGZhbWlseUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDEyJyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG1vY2tGYW1pbHkuZmluZEJ5SWRBbmRVcGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgc3RhcnM6IDAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyRGF0YS5zdGFycykudG9CZSgxMDApOyAvLyAxMDAgKyAwID0gMTAwXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrRmFtaWx5LmZpbmRCeUlkQW5kVXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICAgICAgICAgICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTInLFxyXG4gICAgICAgICAgICAgICAgeyAkaW5jOiB7IHRvdGFsU3RhcnM6IDAgfSB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3IgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgXHJcbiAgICAgICAgICAgICAgICBzdGFyczogMTAwLCBcclxuICAgICAgICAgICAgICAgIGZhbWlseUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDEyJyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgc2F2ZSB0byB0aHJvdyBhbiBlcnJvclxyXG4gICAgICAgICAgICBtb2NrVXNlckRhdGEuc2F2ZSA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBzdGFyczogNTAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJTdGFycyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnRXJyb3IgdXBkYXRpbmcgdXNlciBzdGFycycgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGZhbWlseSB1cGRhdGUgZXJyb3IgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgXHJcbiAgICAgICAgICAgICAgICBzdGFyczogMTAwLCBcclxuICAgICAgICAgICAgICAgIGZhbWlseUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDEyJyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgZmFtaWx5IHVwZGF0ZSB0byB0aHJvdyBhbiBlcnJvclxyXG4gICAgICAgICAgICBtb2NrRmFtaWx5LmZpbmRCeUlkQW5kVXBkYXRlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignRmFtaWx5IHVwZGF0ZSBmYWlsZWQnKSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHN0YXJzOiA1MCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlVXNlclN0YXJzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDUwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyB1c2VyIHN0YXJzJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgcmFuayByZWNhbGN1bGF0aW9uIGVycm9yIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IFxyXG4gICAgICAgICAgICAgICAgc3RhcnM6IDEwMCwgXHJcbiAgICAgICAgICAgICAgICBmYW1pbHlJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMicgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtb2NrRmFtaWx5LmZpbmRCeUlkQW5kVXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XHJcbiAgICAgICAgICAgIC8vIE1vY2sgcmFuayByZWNhbGN1bGF0aW9uIHRvIHRocm93IGFuIGVycm9yXHJcbiAgICAgICAgICAgIG1vY2tSZWNhbGN1bGF0ZUZhbWlseU1lbWJlclJhbmtzLnJlY2FsY3VsYXRlRmFtaWx5TWVtYmVyUmFua3MubW9ja1JlamVjdGVkVmFsdWUoXHJcbiAgICAgICAgICAgICAgICBuZXcgRXJyb3IoJ1JhbmsgY2FsY3VsYXRpb24gZmFpbGVkJylcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgc3RhcnM6IDUwIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVVc2VyU3RhcnMobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNTAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0Vycm9yIHVwZGF0aW5nIHVzZXIgc3RhcnMnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gOS4gdGVzdCBnZXRVc2VyQ29pbnMgQVBJXHJcbiAgICBkZXNjcmliZSgnZ2V0VXNlckNvaW5zJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZ2V0IHVzZXIgY29pbnMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBjb2luczogMjAwIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja1VzZXJEYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckNvaW5zKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnNlbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQ29pbnMgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseVwiLFxyXG4gICAgICAgICAgICAgICAgY29pbnM6IDIwMFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGlmIHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBudWxsIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckNvaW5zKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTAuIHRlc3QgdXBkYXRlVXNlckNvaW5zIEFQSVxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZVVzZXJDb2lucycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB1c2VyIGNvaW5zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgY29pbnM6IDEwMCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBjb2luczogNTAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXJDb2lucyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyRGF0YS5jb2lucykudG9CZSgxNTApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnNlbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiVXNlciBjb2lucyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiLFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVVc2VyQ29pbnMobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBpZiBjb2lucyBpcyBpbnZhbGlkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBjb2luczogJ2ludmFsaWQnIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVVc2VyQ29pbnMobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ1N0YXJzIG11c3QgYmUgYSB2YWxpZCBudW1iZXIuJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDExLiB0ZXN0IGdldExvY2F0aW9uIEFQSVxyXG4gICAgZGVzY3JpYmUoJ2dldExvY2F0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZ2V0IHVzZXIgbG9jYXRpb24gc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBjdXJyZW50TG9jYXRpb246ICdOZXcgWW9yaycgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBtb2NrVXNlckRhdGEgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRMb2NhdGlvbihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zZW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkxvY2F0aW9uIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAnTmV3IFlvcmsnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRMb2NhdGlvbihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDEyLiB0ZXN0IHVwZGF0ZUxvY2F0aW9uIEFQSVxyXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZUxvY2F0aW9uJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgdXBkYXRlIHVzZXIgbG9jYXRpb24gc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBjdXJyZW50TG9jYXRpb246ICdPbGQgTG9jYXRpb24nIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IGN1cnJlbnRMb2NhdGlvbjogJ05ldyBMb2NhdGlvbicgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUxvY2F0aW9uKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VzZXJEYXRhLmN1cnJlbnRMb2NhdGlvbikudG9CZSgnTmV3IExvY2F0aW9uJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc2VuZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIGxvY2F0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbnVsbCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUxvY2F0aW9uKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgaWYgbG9jYXRpb24gaXMgaW52YWxpZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgY3VycmVudExvY2F0aW9uOiAnJyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlTG9jYXRpb24obW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0xvY2F0aW9uIG11c3QgYmUgdmFsaWQuJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIGxvY2F0aW9uIGlzIG5vdCBzdHJpbmcnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IGN1cnJlbnRMb2NhdGlvbjogMTIzIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVMb2NhdGlvbihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnTG9jYXRpb24gbXVzdCBiZSB2YWxpZC4nIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTMuIHRlc3QgZ2V0VXNlclJhbmsgQVBJXHJcbiAgICBkZXNjcmliZSgnZ2V0VXNlclJhbmsnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBnZXQgdXNlciByYW5rIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgcmFua0luRmFtaWx5OiAzIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja1VzZXJEYXRhIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlclJhbmsobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc2VuZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJSYW5rIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIFJhbms6IDNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbnVsbCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJSYW5rKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTQuIHRlc3QgZ2V0VXNlckludGVyZXN0cyBBUElcclxuICAgIGRlc2NyaWJlKCdnZXRVc2VySW50ZXJlc3RzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgZ2V0IHVzZXIgaW50ZXJlc3RzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgaW50ZXJlc3RzOiBbJ3JlYWRpbmcnLCAnc3BvcnRzJ10gfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBtb2NrVXNlckRhdGEgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRVc2VySW50ZXJlc3RzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnNlbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW50ZXJlc3RzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIEludGVyZXN0czogWydyZWFkaW5nJywgJ3Nwb3J0cyddXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRVc2VySW50ZXJlc3RzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTUuIHRlc3Qgc3RhcnRBZHZlbnR1cmUgQVBJXHJcbiAgICBkZXNjcmliZSgnc3RhcnRBZHZlbnR1cmUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBzdGFydCBhZHZlbnR1cmUgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBhZHZlbnR1cmVzOiBbXSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0FkdmVudHVyZURhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja0FkdmVudHVyZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9ja0FkdmVudHVyZS5maW5kQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQWR2ZW50dXJlRGF0YSBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBhZHZlbnR1cmVJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHN0YXJ0QWR2ZW50dXJlKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja0FkdmVudHVyZS5maW5kQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNScpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VzZXJEYXRhLmFkdmVudHVyZXMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zZW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkFkdmVudHVyZSBzdGFydGVkIHN1Y2Nlc3NmdWxseVwiLFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBzdGFydEFkdmVudHVyZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGlmIGFkdmVudHVyZSBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tVc2VyRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcih7IGFkdmVudHVyZXM6IFtdIH0pO1xyXG4gICAgICAgICAgICBtb2NrQWR2ZW50dXJlLmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBhZHZlbnR1cmVJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHN0YXJ0QWR2ZW50dXJlKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwNCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdBZHZlbnR1cmUgbm90IGZvdW5kJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGlmIGFkdmVudHVyZSBhbHJlYWR5IHN0YXJ0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nQWR2ZW50dXJlID0ge1xyXG4gICAgICAgICAgICAgICAgYWR2ZW50dXJlSWQ6IHsgZXF1YWxzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpIH0sXHJcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2VzOiBbXSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2luLXByb2dyZXNzJyxcclxuICAgICAgICAgICAgICAgIGlzQWR2ZW50dXJlQ29tcGxldGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHN0YXJzUmV3YXJkOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBjb2luc1Jld2FyZDogNTAsXHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBhZHZlbnR1cmVzOiBbZXhpc3RpbmdBZHZlbnR1cmVdIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQWR2ZW50dXJlRGF0YSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrQWR2ZW50dXJlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrQWR2ZW50dXJlLmZpbmRCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBZHZlbnR1cmVEYXRhIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IGFkdmVudHVyZUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDE1JyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgc3RhcnRBZHZlbnR1cmUobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ0FkdmVudHVyZSBhbHJlYWR5IHN0YXJ0ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTYuIHRlc3QgY29tcGxldGVDaGFsbGVuZ2UgQVBJXHJcbiAgICBkZXNjcmliZSgnY29tcGxldGVDaGFsbGVuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBjb21wbGV0ZSBjaGFsbGVuZ2Ugc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQ2hhbGxlbmdlID0ge1xyXG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlSWQ6IHsgZXF1YWxzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpIH0sXHJcbiAgICAgICAgICAgICAgICBpc0NvbXBsZXRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWRBdDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tBZHZlbnR1cmVQcm9ncmVzcyA9IHtcclxuICAgICAgICAgICAgICAgIGFkdmVudHVyZUlkOiB7IGVxdWFsczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSB9LFxyXG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlczogW21vY2tDaGFsbGVuZ2VdLCBcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzOiAwLFxyXG4gICAgICAgICAgICAgICAgaXNBZHZlbnR1cmVDb21wbGV0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiAnaW4tcHJvZ3Jlc3MnLFxyXG4gICAgICAgICAgICAgICAgc3RhcnNSZXdhcmQ6IDEwMCwgXHJcbiAgICAgICAgICAgICAgICBjb2luc1Jld2FyZDogNTAgIFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBcclxuICAgICAgICAgICAgICAgIGFkdmVudHVyZXM6IFttb2NrQWR2ZW50dXJlUHJvZ3Jlc3NdLFxyXG4gICAgICAgICAgICAgICAgc3RhcnM6IDEwMCxcclxuICAgICAgICAgICAgICAgIGNvaW5zOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBmYW1pbHlJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb2NrQWR2ZW50dXJlRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGNoYWxsZW5nZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgX2lkOiB7IGVxdWFsczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJzUmV3YXJkOiAyNSxcclxuICAgICAgICAgICAgICAgICAgICBjb2luc1Jld2FyZDogMTVcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtb2NrQWR2ZW50dXJlLmZpbmRCeUlkLm1vY2tSZXR1cm5WYWx1ZSh7XHJcbiAgICAgICAgICAgICAgICBsZWFuOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FkdmVudHVyZURhdGEpXHJcbiAgICAgICAgICAgIH0gYXMgYW55KTtcclxuICAgICAgICAgICAgbW9ja0ZhbWlseS5maW5kQnlJZEFuZFVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhLFxyXG4gICAgICAgICAgICAgICAgYm9keTogeyBcclxuICAgICAgICAgICAgICAgICAgICBhZHZlbnR1cmVJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNScsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbGxlbmdlSWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTYnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY29tcGxldGVDaGFsbGVuZ2UobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQ2hhbGxlbmdlLmlzQ29tcGxldGVkKS50b0JlKHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja0NoYWxsZW5nZS5jb21wbGV0ZWRBdCkudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXNlckRhdGEuc3RhcnMpLnRvQmUoMjI1KTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tVc2VyRGF0YS5jb2lucykudG9CZSgxNjUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIGNvbXBsZXRlIGNoYWxsZW5nZSB3aXRob3V0IGFkdmVudHVyZSBjb21wbGV0aW9uIGJvbnVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQ2hhbGxlbmdlMSA9IHtcclxuICAgICAgICAgICAgICAgIGNoYWxsZW5nZUlkOiB7IGVxdWFsczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSB9LFxyXG4gICAgICAgICAgICAgICAgaXNDb21wbGV0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGVkQXQ6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQ2hhbGxlbmdlMiA9IHtcclxuICAgICAgICAgICAgICAgIGNoYWxsZW5nZUlkOiB7IGVxdWFsczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSkgfSxcclxuICAgICAgICAgICAgICAgIGlzQ29tcGxldGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlZEF0OiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0FkdmVudHVyZVByb2dyZXNzID0ge1xyXG4gICAgICAgICAgICAgICAgYWR2ZW50dXJlSWQ6IHsgZXF1YWxzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpIH0sXHJcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2VzOiBbbW9ja0NoYWxsZW5nZTEsIG1vY2tDaGFsbGVuZ2UyXSwgXHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogMCxcclxuICAgICAgICAgICAgICAgIGlzQWR2ZW50dXJlQ29tcGxldGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2luLXByb2dyZXNzJyxcclxuICAgICAgICAgICAgICAgIHN0YXJzUmV3YXJkOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBjb2luc1Jld2FyZDogNTBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgXHJcbiAgICAgICAgICAgICAgICBhZHZlbnR1cmVzOiBbbW9ja0FkdmVudHVyZVByb2dyZXNzXSxcclxuICAgICAgICAgICAgICAgIHN0YXJzOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBjb2luczogMTAwLFxyXG4gICAgICAgICAgICAgICAgZmFtaWx5SWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTInXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbW9ja0FkdmVudHVyZURhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2VzOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgIF9pZDogeyBlcXVhbHM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSkgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGFyc1Jld2FyZDogMjUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29pbnNSZXdhcmQ6IDE1XHJcbiAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9ja0FkdmVudHVyZS5maW5kQnlJZC5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgICAgICAgICAgICAgbGVhbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBZHZlbnR1cmVEYXRhKVxyXG4gICAgICAgICAgICB9IGFzIGFueSk7XHJcbiAgICAgICAgICAgIG1vY2tGYW1pbHkuZmluZEJ5SWRBbmRVcGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyBcclxuICAgICAgICAgICAgICAgIHVzZXI6IG1vY2tVc2VyRGF0YSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgYWR2ZW50dXJlSWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYWxsZW5nZUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDE2J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGNvbXBsZXRlQ2hhbGxlbmdlKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja0NoYWxsZW5nZTEuaXNDb21wbGV0ZWQpLnRvQmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQWR2ZW50dXJlUHJvZ3Jlc3MucHJvZ3Jlc3MpLnRvQmUoNTApOyBcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tBZHZlbnR1cmVQcm9ncmVzcy5pc0FkdmVudHVyZUNvbXBsZXRlZCkudG9CZShmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1VzZXJEYXRhLnN0YXJzKS50b0JlKDEyNSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrVXNlckRhdGEuY29pbnMpLnRvQmUoMTE1KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGlmIHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBudWxsIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgY29tcGxldGVDaGFsbGVuZ2UobW9ja1JlcSBhcyBhbnksIG1vY2tSZXMgYXMgYW55KTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwNCBpZiBhZHZlbnR1cmUgbm90IGZvdW5kIGluIHVzZXIgcHJvZmlsZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgYWR2ZW50dXJlczogW10gfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGFkdmVudHVyZUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDE1JyxcclxuICAgICAgICAgICAgICAgICAgICBjaGFsbGVuZ2VJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBjb21wbGV0ZUNoYWxsZW5nZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiBcIkFkdmVudHVyZSBub3QgZm91bmQgaW4gdXNlcidzIHByb2ZpbGVcIiB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGlmIGNoYWxsZW5nZSBub3QgZm91bmQgaW4gYWR2ZW50dXJlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQWR2ZW50dXJlUHJvZ3Jlc3MgPSB7XHJcbiAgICAgICAgICAgICAgICBhZHZlbnR1cmVJZDogeyBlcXVhbHM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSkgfSxcclxuICAgICAgICAgICAgICAgIGNoYWxsZW5nZXM6IFtdLCAvLyBObyBjaGFsbGVuZ2VzXHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogMCxcclxuICAgICAgICAgICAgICAgIGlzQWR2ZW50dXJlQ29tcGxldGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2luLXByb2dyZXNzJyxcclxuICAgICAgICAgICAgICAgIHN0YXJzUmV3YXJkOiAxMDAsXHJcbiAgICAgICAgICAgICAgICBjb2luc1Jld2FyZDogNTBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgYWR2ZW50dXJlczogW21vY2tBZHZlbnR1cmVQcm9ncmVzc10gfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGFkdmVudHVyZUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDE1JyxcclxuICAgICAgICAgICAgICAgICAgICBjaGFsbGVuZ2VJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBjb21wbGV0ZUNoYWxsZW5nZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnQ2hhbGxlbmdlIG5vdCBmb3VuZCBpbiBhZHZlbnR1cmUnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgaWYgYWR2ZW50dXJlIGRhdGEgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQ2hhbGxlbmdlID0ge1xyXG4gICAgICAgICAgICAgICAgY2hhbGxlbmdlSWQ6IHsgZXF1YWxzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpIH0sXHJcbiAgICAgICAgICAgICAgICBpc0NvbXBsZXRlZDogZmFsc2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja0FkdmVudHVyZVByb2dyZXNzID0ge1xyXG4gICAgICAgICAgICAgICAgYWR2ZW50dXJlSWQ6IHsgZXF1YWxzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpIH0sXHJcbiAgICAgICAgICAgICAgICBjaGFsbGVuZ2VzOiBbbW9ja0NoYWxsZW5nZV0sXHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBhZHZlbnR1cmVzOiBbbW9ja0FkdmVudHVyZVByb2dyZXNzXSB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1vY2tBZHZlbnR1cmUuZmluZEJ5SWQubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICAgICAgICAgIGxlYW46IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKVxyXG4gICAgICAgICAgICB9IGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEsXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGFkdmVudHVyZUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDE1JyxcclxuICAgICAgICAgICAgICAgICAgICBjaGFsbGVuZ2VJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxNidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBjb21wbGV0ZUNoYWxsZW5nZShtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnQWR2ZW50dXJlIG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAxNy4gdGVzdCBnZXRVc2VyQWR2ZW50dXJlcyBBUElcclxuICAgIGRlc2NyaWJlKCdnZXRVc2VyQWR2ZW50dXJlcycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGdldCB1c2VyIGFkdmVudHVyZXMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrQWR2ZW50dXJlcyA9IFtcclxuICAgICAgICAgICAgICAgIHsgYWR2ZW50dXJlSWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTUnLCBzdGF0dXM6ICdpbi1wcm9ncmVzcycgfVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBhZHZlbnR1cmVzOiBtb2NrQWR2ZW50dXJlcyB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJBZHZlbnR1cmVzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnNlbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiVXNlciBhZHZlbnR1cmVzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIEFkdmVudHVyZTogbW9ja0FkdmVudHVyZXNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBpZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbnVsbCB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJBZHZlbnR1cmVzKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTguIHRlc3QgZ2V0VXNlclB1cmNoYXNlZEl0ZW1zIEFQSVxyXG4gICAgZGVzY3JpYmUoJ2dldFVzZXJQdXJjaGFzZWRJdGVtcycsICgpID0+IHtcclxuICAgICAgICBpdCgnc2hvdWxkIGdldCB1c2VyIHB1cmNoYXNlZCBpdGVtcyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tQdXJjaGFzZWRJdGVtcyA9IFtcclxuICAgICAgICAgICAgICAgIHsgaXRlbUlkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDIwJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBpdGVtSWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMjEnIH1cclxuICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgcHVyY2hhc2VkSXRlbXM6IG1vY2tQdXJjaGFzZWRJdGVtc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRvYyA9IHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyRGF0YSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbW9ja1VzZXIuZmluZEJ5SWQubW9ja1JldHVyblZhbHVlKG1vY2tVc2VyRG9jIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoKSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IHsgdXNlcklkOiAnNTA3ZjFmNzdiY2Y4NmNkNzk5NDM5MDExJyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlclB1cmNoYXNlZEl0ZW1zKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiUHVyY2hhc2VkIGl0ZW1zIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgIHB1cmNoYXNlZEl0ZW1zOiBbJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAyMCcsICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMjEnXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGlmIHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1JlcXVlc3QoeyB1c2VyOiBudWxsIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlclB1cmNoYXNlZEl0ZW1zKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDMgaWYgdHJ5aW5nIHRvIGFjY2VzcyBvdGhlciB1c2VyIGl0ZW1zJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBfaWQ6ICdkaWZmZXJlbnQtdXNlci1pZCcgfSksXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJQdXJjaGFzZWRJdGVtcyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDMpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnRm9yYmlkZGVuJyB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IGlmIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRvYyA9IHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1vY2tVc2VyLmZpbmRCeUlkLm1vY2tSZXR1cm5WYWx1ZShtb2NrVXNlckRvYyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCksXHJcbiAgICAgICAgICAgICAgICBib2R5OiB7IHVzZXJJZDogJzUwN2YxZjc3YmNmODZjZDc5OTQzOTAxMScgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGdldFVzZXJQdXJjaGFzZWRJdGVtcyhtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IGVycm9yOiAnVXNlciBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ2dldFVzZXJBdmF0YXInLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCBnZXQgdXNlciBhdmF0YXIgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBcclxuICAgICAgICAgICAgICAgIGF2YXRhcjogJy9hdmF0YXJzL2NoaWxkLWJveS0xLnBuZycgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbW9ja1VzZXJEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckF2YXRhcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF2YXRhciByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6ICcvYXZhdGFycy9jaGlsZC1ib3ktMS5wbmcnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgaWYgdXNlciBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBnZXRVc2VyQXZhdGFyKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBhdmF0YXIgZm9ybWF0cyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcclxuICAgICAgICAgICAgICAgIHsgYXZhdGFyOiAnL2F2YXRhcnMvcGFyZW50LXdvbWFuLnBuZycsIGRlc2NyaXB0aW9uOiAncGFyZW50IGF2YXRhcicgfSxcclxuICAgICAgICAgICAgICAgIHsgYXZhdGFyOiAnL2F2YXRhcnMvY2hpbGQtZ2lybC0yLnBuZycsIGRlc2NyaXB0aW9uOiAnY2hpbGQgYXZhdGFyJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBhdmF0YXI6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLCBkZXNjcmlwdGlvbjogJ2V4dGVybmFsIFVSTCcgfSxcclxuICAgICAgICAgICAgICAgIHsgYXZhdGFyOiAnL2RlZmF1bHQtYXZhdGFyLnN2ZycsIGRlc2NyaXB0aW9uOiAnZGVmYXVsdCBhdmF0YXInIH0sXHJcbiAgICAgICAgICAgICAgICB7IGF2YXRhcjogJycsIGRlc2NyaXB0aW9uOiAnZW1wdHkgc3RyaW5nJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBhdmF0YXI6IG51bGwsIGRlc2NyaXB0aW9uOiAnbnVsbCBhdmF0YXInIH0sXHJcbiAgICAgICAgICAgICAgICB7IGF2YXRhcjogdW5kZWZpbmVkLCBkZXNjcmlwdGlvbjogJ3VuZGVmaW5lZCBhdmF0YXInIH1cclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgeyBhdmF0YXIsIGRlc2NyaXB0aW9uIH0gb2YgdGVzdENhc2VzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtb2NrVXNlckRhdGEgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1VzZXIoeyBhdmF0YXIgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgdXNlcjogbW9ja1VzZXJEYXRhIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9ja1JlcyA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVzcG9uc2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBnZXRVc2VyQXZhdGFyKG1vY2tSZXEgYXMgYW55LCBtb2NrUmVzIGFzIGFueSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQXZhdGFyIHJldHJpZXZlZCBzdWNjZXNzZnVsbHlcIixcclxuICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IGF2YXRhclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmVyIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBub3JtYWwgdXNlciBvYmplY3QgZmlyc3RcclxuICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUaGVuIG92ZXJyaWRlIHRoZSBhdmF0YXIgcHJvcGVydHkgd2l0aCBhIGdldHRlciB0aGF0IHRocm93c1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9ja1VzZXJEYXRhLCAnYXZhdGFyJywge1xyXG4gICAgICAgICAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVxID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXF1ZXN0KHsgXHJcbiAgICAgICAgICAgICAgICB1c2VyOiBtb2NrVXNlckRhdGEgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckF2YXRhcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IFwiRXJyb3IgZmV0Y2hpbmcgYXZhdGFyXCIgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgdXNlciB3aXRoIGFsbCBhdmF0YXIgZWRnZSBjYXNlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgLy8gVGVzdCB2YXJpb3VzIGVkZ2UgY2FzZXMgZm9yIGF2YXRhciBwcm9wZXJ0eVxyXG4gICAgICAgICAgICBjb25zdCBlZGdlQ2FzZXMgPSBbXHJcbiAgICAgICAgICAgICAgICB7IGF2YXRhcjogMCwgZGVzY3JpcHRpb246ICdudW1iZXIgemVybycgfSxcclxuICAgICAgICAgICAgICAgIHsgYXZhdGFyOiBmYWxzZSwgZGVzY3JpcHRpb246ICdib29sZWFuIGZhbHNlJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBhdmF0YXI6IFtdLCBkZXNjcmlwdGlvbjogJ2VtcHR5IGFycmF5JyB9LFxyXG4gICAgICAgICAgICAgICAgeyBhdmF0YXI6IHt9LCBkZXNjcmlwdGlvbjogJ2VtcHR5IG9iamVjdCcgfSxcclxuICAgICAgICAgICAgICAgIHsgYXZhdGFyOiAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBRUFBQUFCQ0FZQUFBQWZGY1NKQUFBQURVbEVRVlI0Mm1QOC81K2hIZ0FIZ2dKL1BjaEk3d0FBQUFCSlJVNUVya0pnZ2c9PScsIGRlc2NyaXB0aW9uOiAnYmFzZTY0IGltYWdlJyB9XHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHsgYXZhdGFyLCBkZXNjcmlwdGlvbiB9IG9mIGVkZ2VDYXNlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9ja1VzZXJEYXRhID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tVc2VyKHsgYXZhdGFyIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IHVzZXI6IG1vY2tVc2VyRGF0YSB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vY2tSZXMgPSB0ZXN0VXRpbHMuY3JlYXRlTW9ja1Jlc3BvbnNlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckF2YXRhcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF2YXRhciByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXZhdGFyOiBhdmF0YXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHVzZXIgb2JqZWN0IHdpdGhvdXQgYXZhdGFyIHByb3BlcnR5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdXNlciB3aXRob3V0IGF2YXRhciBwcm9wZXJ0eVxyXG4gICAgICAgICAgICBjb25zdCB1c2VyV2l0aG91dEF2YXRhciA9IHRlc3RVdGlscy5jcmVhdGVNb2NrVXNlcigpO1xyXG4gICAgICAgICAgICBkZWxldGUgKHVzZXJXaXRob3V0QXZhdGFyIGFzIGFueSkuYXZhdGFyO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogdXNlcldpdGhvdXRBdmF0YXIgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckF2YXRhcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF2YXRhciByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggbWluaW1hbCB1c2VyIG9iamVjdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgLy8gVGVzdCB3aXRoIHZlcnkgYmFzaWMgdXNlciBvYmplY3RcclxuICAgICAgICAgICAgY29uc3QgbWluaW1hbFVzZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBfaWQ6ICc1MDdmMWY3N2JjZjg2Y2Q3OTk0MzkwMTEnLFxyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiAnL3NpbXBsZS1hdmF0YXIucG5nJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgbW9ja1JlcSA9IHRlc3RVdGlscy5jcmVhdGVNb2NrUmVxdWVzdCh7IFxyXG4gICAgICAgICAgICAgICAgdXNlcjogbWluaW1hbFVzZXIgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzID0gdGVzdFV0aWxzLmNyZWF0ZU1vY2tSZXNwb25zZSgpO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZ2V0VXNlckF2YXRhcihtb2NrUmVxIGFzIGFueSwgbW9ja1JlcyBhcyBhbnkpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KG1vY2tSZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICAgICAgICBleHBlY3QobW9ja1Jlcy5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF2YXRhciByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6ICcvc2ltcGxlLWF2YXRhci5wbmcnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==