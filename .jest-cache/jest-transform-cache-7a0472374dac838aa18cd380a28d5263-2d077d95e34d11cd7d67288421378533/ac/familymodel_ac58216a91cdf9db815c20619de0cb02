e01cd32bd688bacf6155c020393c29a0
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Family = void 0;
const mongoose_1 = require("mongoose");
const goal_schema_1 = require("./schemas/goal.schema");
const notification_schema_1 = require("./schemas/notification.schema");
const unlockedAchievementSchema_schema_1 = require("./schemas/unlockedAchievementSchema.schema");
const story_schema_1 = require("./schemas/story.schema");
const familySchema = new mongoose_1.Schema({
    _id: { type: mongoose_1.Schema.Types.ObjectId, auto: true },
    familyName: { type: String, required: true, unique: true },
    members: [
        {
            _id: { type: mongoose_1.Types.ObjectId, ref: "User", required: true },
            name: { type: String, required: true },
            role: { type: String, required: true, enum: ['parent', 'admin', 'child'] },
            gender: { type: String, required: true, enum: ['female', 'male'] },
            avatar: { type: String, required: true },
        },
    ],
    email: { type: String, required: true, unique: true },
    createdAt: { type: Date, required: true },
    totalStars: { type: Number, default: 0 },
    tasks: { type: Number, default: 0 },
    notifications: { type: [notification_schema_1.notificationSchema], default: [] },
    goals: { type: [goal_schema_1.goalSchema], default: [] },
    achievements: { type: [unlockedAchievementSchema_schema_1.unlockedAchievementSchema], default: [] },
    stars: {
        daily: { type: Number, default: 0 },
        weekly: { type: Number, default: 0 },
        monthly: { type: Number, default: 0 },
        yearly: { type: Number, default: 0 }
    },
    taskCounts: {
        daily: { type: Number, default: 0 },
        weekly: { type: Number, default: 0 },
        monthly: { type: Number, default: 0 },
        yearly: { type: Number, default: 0 }
    },
    familyAvatar: { type: String, required: true },
    sharedStories: { type: [story_schema_1.storySchema], default: [] },
});
// Ensure virtuals are included in JSON response
familySchema.set("toJSON", { virtuals: true });
familySchema.set("toObject", { virtuals: true });
exports.Family = (0, mongoose_1.model)("Family", familySchema);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxVU0VSXFxEZXNrdG9wXFxndWFyZGlhbi1ncm92ZVxcZ3VhcmRpYW4tZ3JvdmUtYmFja2VuZFxcc3JjXFxtb2RlbHNcXGZhbWlseS5tb2RlbC50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSx1Q0FBZ0Q7QUFHaEQsdURBQW1EO0FBQ25ELHVFQUFtRTtBQUNuRSxpR0FBdUY7QUFDdkYseURBQXFEO0FBRXJELE1BQU0sWUFBWSxHQUFHLElBQUksaUJBQU0sQ0FBVTtJQUNyQyxHQUFHLEVBQUUsRUFBRSxJQUFJLEVBQUUsaUJBQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7SUFDaEQsVUFBVSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7SUFDMUQsT0FBTyxFQUFFO1FBQ0w7WUFDSSxHQUFHLEVBQUUsRUFBRSxJQUFJLEVBQUUsZ0JBQUssQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFO1lBQzFELElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtZQUN0QyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRTtZQUMxRSxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxFQUFFO1lBQ2xFLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtTQUMzQztLQUNKO0lBQ0QsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7SUFDckQsU0FBUyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFO0lBQ3pDLFVBQVUsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRTtJQUN4QyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7SUFDbkMsYUFBYSxFQUFFLEVBQUUsSUFBSSxFQUFFLENBQUMsd0NBQWtCLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFO0lBQzFELEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLHdCQUFVLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFO0lBQzFDLFlBQVksRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLDREQUF5QixDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRTtJQUNoRSxLQUFLLEVBQUU7UUFDSCxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7UUFDbkMsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFO1FBQ3BDLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRTtRQUNyQyxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7S0FDdkM7SUFDRCxVQUFVLEVBQUU7UUFDUixLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7UUFDbkMsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFO1FBQ3BDLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRTtRQUNyQyxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7S0FDdkM7SUFDRCxZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUU7SUFDOUMsYUFBYSxFQUFFLEVBQUUsSUFBSSxFQUFFLENBQUMsMEJBQVcsQ0FBQyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUU7Q0FDdEQsQ0FBQyxDQUFDO0FBRUgsZ0RBQWdEO0FBQ2hELFlBQVksQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFDL0MsWUFBWSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUVwQyxRQUFBLE1BQU0sR0FBRyxJQUFBLGdCQUFLLEVBQVUsUUFBUSxFQUFFLFlBQVksQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcVVNFUlxcRGVza3RvcFxcZ3VhcmRpYW4tZ3JvdmVcXGd1YXJkaWFuLWdyb3ZlLWJhY2tlbmRcXHNyY1xcbW9kZWxzXFxmYW1pbHkubW9kZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NoZW1hLCBtb2RlbCwgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcclxuaW1wb3J0IHsgSUZhbWlseSB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lGYW1pbHlcIjtcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuL3VzZXIubW9kZWxcIjtcclxuaW1wb3J0IHsgZ29hbFNjaGVtYSB9IGZyb20gXCIuL3NjaGVtYXMvZ29hbC5zY2hlbWFcIjtcclxuaW1wb3J0IHsgbm90aWZpY2F0aW9uU2NoZW1hIH0gZnJvbSBcIi4vc2NoZW1hcy9ub3RpZmljYXRpb24uc2NoZW1hXCI7XHJcbmltcG9ydCB7IHVubG9ja2VkQWNoaWV2ZW1lbnRTY2hlbWEgfSBmcm9tIFwiLi9zY2hlbWFzL3VubG9ja2VkQWNoaWV2ZW1lbnRTY2hlbWEuc2NoZW1hXCI7XHJcbmltcG9ydCB7IHN0b3J5U2NoZW1hIH0gZnJvbSBcIi4vc2NoZW1hcy9zdG9yeS5zY2hlbWFcIjtcclxuXHJcbmNvbnN0IGZhbWlseVNjaGVtYSA9IG5ldyBTY2hlbWE8SUZhbWlseT4oe1xyXG4gICAgX2lkOiB7IHR5cGU6IFNjaGVtYS5UeXBlcy5PYmplY3RJZCwgYXV0bzogdHJ1ZSB9LFxyXG4gICAgZmFtaWx5TmFtZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB1bmlxdWU6IHRydWUgfSxcclxuICAgIG1lbWJlcnM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9pZDogeyB0eXBlOiBUeXBlcy5PYmplY3RJZCwgcmVmOiBcIlVzZXJcIiwgcmVxdWlyZWQ6IHRydWUgfSxcclxuICAgICAgICAgICAgbmFtZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHJvbGU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSwgZW51bTogWydwYXJlbnQnLCAnYWRtaW4nLCAnY2hpbGQnXSB9LFxyXG4gICAgICAgICAgICBnZW5kZXI6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSwgZW51bTogWydmZW1hbGUnLCAnbWFsZSddIH0sXHJcbiAgICAgICAgICAgIGF2YXRhcjogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgICAgICAgfSxcclxuICAgIF0sXHJcbiAgICBlbWFpbDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB1bmlxdWU6IHRydWUgfSxcclxuICAgIGNyZWF0ZWRBdDogeyB0eXBlOiBEYXRlLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgdG90YWxTdGFyczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgIHRhc2tzOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gICAgbm90aWZpY2F0aW9uczogeyB0eXBlOiBbbm90aWZpY2F0aW9uU2NoZW1hXSwgZGVmYXVsdDogW10gfSxcclxuICAgIGdvYWxzOiB7IHR5cGU6IFtnb2FsU2NoZW1hXSwgZGVmYXVsdDogW10gfSxcclxuICAgIGFjaGlldmVtZW50czogeyB0eXBlOiBbdW5sb2NrZWRBY2hpZXZlbWVudFNjaGVtYV0sIGRlZmF1bHQ6IFtdIH0sXHJcbiAgICBzdGFyczoge1xyXG4gICAgICAgIGRhaWx5OiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gICAgICAgIHdlZWtseTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgICAgICBtb250aGx5OiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gICAgICAgIHllYXJseTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfVxyXG4gICAgfSxcclxuICAgIHRhc2tDb3VudHM6IHtcclxuICAgICAgICBkYWlseTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgICAgICB3ZWVrbHk6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0sXHJcbiAgICAgICAgbW9udGhseTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgICAgICB5ZWFybHk6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH1cclxuICAgIH0sXHJcbiAgICBmYW1pbHlBdmF0YXI6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgc2hhcmVkU3RvcmllczogeyB0eXBlOiBbc3RvcnlTY2hlbWFdLCBkZWZhdWx0OiBbXSB9LFxyXG59KTtcclxuXHJcbi8vIEVuc3VyZSB2aXJ0dWFscyBhcmUgaW5jbHVkZWQgaW4gSlNPTiByZXNwb25zZVxyXG5mYW1pbHlTY2hlbWEuc2V0KFwidG9KU09OXCIsIHsgdmlydHVhbHM6IHRydWUgfSk7XHJcbmZhbWlseVNjaGVtYS5zZXQoXCJ0b09iamVjdFwiLCB7IHZpcnR1YWxzOiB0cnVlIH0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IEZhbWlseSA9IG1vZGVsPElGYW1pbHk+KFwiRmFtaWx5XCIsIGZhbWlseVNjaGVtYSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==