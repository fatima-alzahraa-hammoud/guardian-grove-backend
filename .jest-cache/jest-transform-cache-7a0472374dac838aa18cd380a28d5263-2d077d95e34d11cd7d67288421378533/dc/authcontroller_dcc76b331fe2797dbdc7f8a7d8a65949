812a73286a2e5a881a0278567236399c
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get forgetPassword () {
        return forgetPassword;
    },
    get login () {
        return login;
    },
    get register () {
        return register;
    }
});
const _bcrypt = /*#__PURE__*/ _interop_require_default(require("bcrypt"));
const _error = require("../utils/error");
const _usermodel = require("../models/user.model");
const _dotenv = /*#__PURE__*/ _interop_require_default(require("dotenv"));
const _jsonwebtoken = /*#__PURE__*/ _interop_require_default(require("jsonwebtoken"));
const _familymodel = require("../models/family.model");
const _generateSecurePassword = require("../utils/generateSecurePassword");
const _emailservice = require("../services/email.service");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
_dotenv.default.config();
const JWT_SECRET_KEY = process.env.JWT_SECRET;
const login = async (req, res)=>{
    try {
        const { name, email, password } = req.body;
        if (!name || !email || !password) {
            return (0, _error.throwError)({
                message: "Name, email, and password are required.",
                res,
                status: 400
            });
        }
        const user = await _usermodel.User.findOne({
            name: name,
            email: email
        });
        if (!user) {
            return (0, _error.throwError)({
                message: "Invalid credentials. User not found.",
                res,
                status: 404
            });
        }
        // Verify password
        const isMatch = await _bcrypt.default.compare(password, user.password);
        if (!isMatch) {
            return (0, _error.throwError)({
                message: "Invalid password.",
                res,
                status: 401
            });
        }
        if (!JWT_SECRET_KEY) {
            return (0, _error.throwError)({
                message: "JWT_SECRET_KEY is not defined",
                res,
                status: 500
            });
        }
        const token = await _jsonwebtoken.default.sign({
            userId: user.id,
            role: user.role
        }, JWT_SECRET_KEY);
        res.status(200).json({
            user: user,
            token,
            requiresPasswordChange: user.isTempPassword || false,
            message: user.isTempPassword ? 'Please set a new password' : 'Login successful'
        });
    } catch (error) {
        return (0, _error.throwError)({
            message: "Something went wrong while logging in.",
            res,
            status: 500
        });
    }
};
const register = async (req, res)=>{
    try {
        const data = req.body;
        const { name, email, password, confirmPassword, birthday, gender, role, avatar, interests, familyName, familyAvatar } = data;
        // verify all fields are filled
        if (!name || !email || !password || !confirmPassword || !birthday || !gender || !role || !avatar || !interests || !familyName || !familyAvatar) {
            return (0, _error.throwError)({
                message: "All required fields must be filled.",
                res,
                status: 400
            });
        }
        if (password !== confirmPassword) {
            return (0, _error.throwError)({
                message: "Passwords do not match",
                res,
                status: 400
            });
        }
        // Email Validation
        const emailRegex = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
        if (!emailRegex.test(email)) {
            return (0, _error.throwError)({
                message: "Invalid email format.",
                res,
                status: 400
            });
        }
        // Role validation
        const validRoles = [
            'parent',
            'admin'
        ];
        if (!validRoles.includes(role)) {
            if (role === "child") {
                return (0, _error.throwError)({
                    message: "Children must be added by a parent.",
                    res,
                    status: 400
                });
            }
            return (0, _error.throwError)({
                message: "Invalid role.",
                res,
                status: 400
            });
        }
        if (!Array.isArray(interests)) {
            return (0, _error.throwError)({
                message: "Interests must be an array.",
                res,
                status: 400
            });
        }
        // Gender Validation
        const validGenders = [
            'male',
            'female'
        ];
        if (!validGenders.includes(gender)) {
            return (0, _error.throwError)({
                message: "Gender must be either 'male' or 'female'.",
                res,
                status: 400
            });
        }
        // Birthday Validation
        if (isNaN(new Date(birthday).getTime())) {
            return (0, _error.throwError)({
                message: "Invalid birthday format.",
                res,
                status: 400
            });
        }
        const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        if (!passwordRegex.test(password)) {
            return (0, _error.throwError)({
                message: "Password must be at least 8 characters long, include an uppercase letter, lowercase letter, a number, and a special character.",
                res,
                status: 400
            });
        }
        const hashedPassword = await _bcrypt.default.hash(password, 12);
        // Family Assignment
        let family = await _familymodel.Family.findOne({
            email
        });
        if (!family) {
            family = new _familymodel.Family({
                familyName: familyName,
                email,
                familyAvatar: familyAvatar,
                members: [],
                createdAt: new Date()
            });
            await family.save();
        } else {
            if (family.familyName !== familyName) {
                return (0, _error.throwError)({
                    message: "Wrong family name",
                    res,
                    status: 400
                });
            }
        }
        // Check if a family member with the same name already exists
        const existingFamilyMember = await _usermodel.User.findOne({
            name,
            familyId: family._id
        });
        if (existingFamilyMember) {
            return (0, _error.throwError)({
                message: "A member with this name already exists in the family.",
                res,
                status: 400
            });
        }
        // Create the user and link to family
        const newUser = await _usermodel.User.create({
            ...data,
            password: hashedPassword,
            familyId: family._id
        });
        // Add user to the family members list if not already present
        if (!family.members.includes(newUser.id)) {
            family.members.push({
                _id: newUser.id,
                role,
                name,
                gender,
                avatar
            });
            await family.save();
        }
        if (!JWT_SECRET_KEY) {
            return (0, _error.throwError)({
                message: "JWT_SECRET_KEY is not defined",
                res,
                status: 500
            });
        }
        const token = await _jsonwebtoken.default.sign({
            userId: newUser.id,
            role: newUser.role
        }, JWT_SECRET_KEY);
        res.status(200).send({
            user: newUser,
            token: token,
            family: family
        });
    } catch (error) {
        return (0, _error.throwError)({
            message: "Something went wrong while registering.",
            res,
            status: 500
        });
    }
};
const forgetPassword = async (req, res)=>{
    try {
        const { name, email } = req.body;
        const user = await _usermodel.User.findOne({
            email,
            name
        });
        if (!user) {
            return (0, _error.throwError)({
                message: "Invalid credentials. User not found.",
                res,
                status: 404
            });
        }
        const tempPassword = (0, _generateSecurePassword.generateSecurePassword)();
        const hashedPassword = await _bcrypt.default.hash(tempPassword, 12);
        user.password = hashedPassword;
        user.isTempPassword = true;
        user.passwordChangedAt = new Date();
        await user.save();
        const from = `"Guardian Grove" <${process.env.EMAIL_USERNAME}>`;
        const to = email;
        const subject = "Your Temporary Password";
        const html = `
            <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #2c3e50;">Hello ${user.name},</h2>
                <p>Your temporary password is: <strong>${tempPassword}</strong></p>
                <p>This password will expire in 1 hour.</p>
                <p>Please use this to login and change your password immediately.</p>
                <br/>
                <p>Thank you,</p>
                <p><strong>Guardian Grove Team</strong></p>
            </div>
        `;
        // Send email with the temporary password
        await (0, _emailservice.sendMail)(from, to, subject, html);
        res.status(200).send({
            message: "Temporary password sent to your email."
        });
    } catch (error) {
        return (0, _error.throwError)({
            message: "Error sending temporary password.",
            res,
            status: 500
        });
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcVVNFUlxcRGVza3RvcFxcZ3VhcmRpYW4tZ3JvdmVcXGd1YXJkaWFuLWdyb3ZlLWJhY2tlbmRcXHNyY1xcY29udHJvbGxlcnNcXGF1dGguY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXNwb25zZSwgUmVxdWVzdCB9IGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdFwiO1xyXG5pbXBvcnQgeyB0aHJvd0Vycm9yIH0gZnJvbSBcIi4uL3V0aWxzL2Vycm9yXCI7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3VzZXIubW9kZWxcIjtcclxuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XHJcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5pbXBvcnQgeyBGYW1pbHkgfSBmcm9tIFwiLi4vbW9kZWxzL2ZhbWlseS5tb2RlbFwiO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZVNlY3VyZVBhc3N3b3JkIH0gZnJvbSBcIi4uL3V0aWxzL2dlbmVyYXRlU2VjdXJlUGFzc3dvcmRcIjtcclxuaW1wb3J0IHsgc2VuZE1haWwgfSBmcm9tIFwiLi4vc2VydmljZXMvZW1haWwuc2VydmljZVwiO1xyXG5cclxuZG90ZW52LmNvbmZpZygpO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVF9LRVkgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUO1xyXG5cclxuXHJcbi8vIGxvZ2luXHJcbmV4cG9ydCBjb25zdCBsb2dpbiA9IGFzeW5jICggcmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlKSA6IFByb21pc2U8dm9pZD4gPT4ge1xyXG5cclxuICAgIHRyeXtcclxuICAgICAgICBjb25zdCB7bmFtZSwgZW1haWwsIHBhc3N3b3JkfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgICBpZiAoIW5hbWUgfHwgIWVtYWlsIHx8ICFwYXNzd29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiTmFtZSwgZW1haWwsIGFuZCBwYXNzd29yZCBhcmUgcmVxdWlyZWQuXCIsIHJlcywgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7XHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIGVtYWlsOiBlbWFpbCwgXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiSW52YWxpZCBjcmVkZW50aWFscy4gVXNlciBub3QgZm91bmQuXCIsIHJlcywgc3RhdHVzOiA0MDQgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWZXJpZnkgcGFzc3dvcmRcclxuICAgICAgICBjb25zdCBpc01hdGNoID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xyXG4gICAgICAgIGlmICghaXNNYXRjaCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiSW52YWxpZCBwYXNzd29yZC5cIiwgcmVzLCBzdGF0dXM6IDQwMSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghSldUX1NFQ1JFVF9LRVkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkpXVF9TRUNSRVRfS0VZIGlzIG5vdCBkZWZpbmVkXCIsIHJlcywgc3RhdHVzOiA1MDAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGp3dC5zaWduKHsgdXNlcklkOiB1c2VyLmlkLCByb2xlOiB1c2VyLnJvbGUgfSwgSldUX1NFQ1JFVF9LRVkpO1xyXG5cclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICAgIHVzZXI6IHVzZXIsXHJcbiAgICAgICAgICAgIHRva2VuLFxyXG4gICAgICAgICAgICByZXF1aXJlc1Bhc3N3b3JkQ2hhbmdlOiB1c2VyLmlzVGVtcFBhc3N3b3JkIHx8IGZhbHNlLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiB1c2VyLmlzVGVtcFBhc3N3b3JkIFxyXG4gICAgICAgICAgICAgICAgPyAnUGxlYXNlIHNldCBhIG5ldyBwYXNzd29yZCcgXHJcbiAgICAgICAgICAgICAgICA6ICdMb2dpbiBzdWNjZXNzZnVsJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfWNhdGNoKGVycm9yKXtcclxuICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2hpbGUgbG9nZ2luZyBpbi5cIiwgcmVzLCBzdGF0dXM6IDUwMH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyByZWdpc3RlclxyXG5leHBvcnQgY29uc3QgcmVnaXN0ZXIgPSBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlKSA6IFByb21pc2U8dm9pZD4gPT4ge1xyXG4gICAgdHJ5e1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keTtcclxuICAgICAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwYXNzd29yZCwgY29uZmlybVBhc3N3b3JkLCBiaXJ0aGRheSwgZ2VuZGVyLCByb2xlLCBhdmF0YXIsIGludGVyZXN0cywgZmFtaWx5TmFtZSwgZmFtaWx5QXZhdGFyIH0gPSBkYXRhO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHZlcmlmeSBhbGwgZmllbGRzIGFyZSBmaWxsZWRcclxuICAgICAgICBpZiAoIW5hbWUgfHwgIWVtYWlsIHx8ICFwYXNzd29yZCB8fCAhY29uZmlybVBhc3N3b3JkIHx8ICFiaXJ0aGRheSB8fCAhZ2VuZGVyIHx8ICFyb2xlIHx8ICFhdmF0YXIgfHwgIWludGVyZXN0cyB8fCAhZmFtaWx5TmFtZSB8fCAhZmFtaWx5QXZhdGFyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJBbGwgcmVxdWlyZWQgZmllbGRzIG11c3QgYmUgZmlsbGVkLlwiLCByZXMsIHN0YXR1czogNDAwfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCl7XHJcbiAgICAgICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJQYXNzd29yZHMgZG8gbm90IG1hdGNoXCIsIHJlcywgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFbWFpbCBWYWxpZGF0aW9uXHJcbiAgICAgICAgY29uc3QgZW1haWxSZWdleCA9IC9eXFx3KyhbXFwuLV0/XFx3KykqQFxcdysoW1xcLi1dP1xcdyspKihcXC5cXHd7MiwzfSkrJC87XHJcbiAgICAgICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJJbnZhbGlkIGVtYWlsIGZvcm1hdC5cIiwgcmVzLCBzdGF0dXM6IDQwMH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUm9sZSB2YWxpZGF0aW9uXHJcbiAgICAgICAgY29uc3QgdmFsaWRSb2xlcyA9IFsncGFyZW50JywgJ2FkbWluJ107XHJcbiAgICAgICAgaWYgKCF2YWxpZFJvbGVzLmluY2x1ZGVzKHJvbGUpKSB7XHJcbiAgICAgICAgICAgIGlmIChyb2xlID09PSBcImNoaWxkXCIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkNoaWxkcmVuIG11c3QgYmUgYWRkZWQgYnkgYSBwYXJlbnQuXCIsIHJlcywgc3RhdHVzOiA0MDB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiSW52YWxpZCByb2xlLlwiLCByZXMsIHN0YXR1czogNDAwfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShpbnRlcmVzdHMpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJJbnRlcmVzdHMgbXVzdCBiZSBhbiBhcnJheS5cIiwgcmVzLCBzdGF0dXM6IDQwMCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEdlbmRlciBWYWxpZGF0aW9uXHJcbiAgICAgICAgY29uc3QgdmFsaWRHZW5kZXJzID0gWydtYWxlJywgJ2ZlbWFsZSddO1xyXG4gICAgICAgIGlmICghdmFsaWRHZW5kZXJzLmluY2x1ZGVzKGdlbmRlcikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkdlbmRlciBtdXN0IGJlIGVpdGhlciAnbWFsZScgb3IgJ2ZlbWFsZScuXCIsIHJlcywgc3RhdHVzOiA0MDB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEJpcnRoZGF5IFZhbGlkYXRpb25cclxuICAgICAgICBpZiAoaXNOYU4obmV3IERhdGUoYmlydGhkYXkpLmdldFRpbWUoKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkludmFsaWQgYmlydGhkYXkgZm9ybWF0LlwiLCByZXMsIHN0YXR1czogNDAwIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcGFzc3dvcmRSZWdleCA9IC9eKD89LipbYS16XSkoPz0uKltBLVpdKSg/PS4qXFxkKSg/PS4qW0AkISUqPyZdKVtBLVphLXpcXGRAJCElKj8mXXs4LH0kLztcclxuICAgICAgICBpZiAoIXBhc3N3b3JkUmVnZXgudGVzdChwYXNzd29yZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3Ioe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nLCBpbmNsdWRlIGFuIHVwcGVyY2FzZSBsZXR0ZXIsIGxvd2VyY2FzZSBsZXR0ZXIsIGEgbnVtYmVyLCBhbmQgYSBzcGVjaWFsIGNoYXJhY3Rlci5cIixcclxuICAgICAgICAgICAgICAgIHJlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogNDAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTIpO1xyXG5cclxuXHJcbiAgICAgICAgIC8vIEZhbWlseSBBc3NpZ25tZW50XHJcbiAgICAgICAgIGxldCBmYW1pbHkgPSBhd2FpdCBGYW1pbHkuZmluZE9uZSh7IGVtYWlsIH0pO1xyXG5cclxuICAgICAgICAgaWYgKCFmYW1pbHkpIHtcclxuICAgICAgICAgICAgZmFtaWx5ID0gbmV3IEZhbWlseSh7XHJcbiAgICAgICAgICAgICAgICBmYW1pbHlOYW1lOiBmYW1pbHlOYW1lLFxyXG4gICAgICAgICAgICAgICAgZW1haWwsXHJcbiAgICAgICAgICAgICAgICBmYW1pbHlBdmF0YXI6IGZhbWlseUF2YXRhcixcclxuICAgICAgICAgICAgICAgIG1lbWJlcnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhd2FpdCBmYW1pbHkuc2F2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBpZiAoZmFtaWx5LmZhbWlseU5hbWUgIT09IGZhbWlseU5hbWUpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIldyb25nIGZhbWlseSBuYW1lXCIsIHJlcywgc3RhdHVzOiA0MDAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYSBmYW1pbHkgbWVtYmVyIHdpdGggdGhlIHNhbWUgbmFtZSBhbHJlYWR5IGV4aXN0c1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRmFtaWx5TWVtYmVyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZSwgZmFtaWx5SWQ6IGZhbWlseS5faWQgfSk7XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nRmFtaWx5TWVtYmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJBIG1lbWJlciB3aXRoIHRoaXMgbmFtZSBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgZmFtaWx5LlwiLCByZXMsIHN0YXR1czogNDAwIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSB1c2VyIGFuZCBsaW5rIHRvIGZhbWlseVxyXG4gICAgICAgIGNvbnN0IG5ld1VzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7Li4uZGF0YSwgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLCBmYW1pbHlJZDogZmFtaWx5Ll9pZH0pOyBcclxuXHJcbiAgICAgICAgLy8gQWRkIHVzZXIgdG8gdGhlIGZhbWlseSBtZW1iZXJzIGxpc3QgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgIGlmICghZmFtaWx5Lm1lbWJlcnMuaW5jbHVkZXMobmV3VXNlci5pZCkpIHtcclxuICAgICAgICAgICAgZmFtaWx5Lm1lbWJlcnMucHVzaCh7X2lkOiBuZXdVc2VyLmlkLCByb2xlLCBuYW1lLCBnZW5kZXIsIGF2YXRhcn0pO1xyXG4gICAgICAgICAgICBhd2FpdCBmYW1pbHkuc2F2ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICghSldUX1NFQ1JFVF9LRVkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkpXVF9TRUNSRVRfS0VZIGlzIG5vdCBkZWZpbmVkXCIsIHJlcywgc3RhdHVzOiA1MDAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGp3dC5zaWduKHsgdXNlcklkOiBuZXdVc2VyLmlkLCByb2xlOiBuZXdVc2VyLnJvbGUgIH0sIEpXVF9TRUNSRVRfS0VZKTtcclxuXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoe3VzZXI6IG5ld1VzZXIsIHRva2VuOiB0b2tlbiwgZmFtaWx5OiBmYW1pbHl9KTtcclxuXHJcbiAgICB9Y2F0Y2goZXJyb3Ipe1xyXG4gICAgICAgIHJldHVybiB0aHJvd0Vycm9yKHsgbWVzc2FnZTogXCJTb21ldGhpbmcgd2VudCB3cm9uZyB3aGlsZSByZWdpc3RlcmluZy5cIiwgcmVzLCBzdGF0dXM6IDUwMH0pO1xyXG4gICAgfVxyXG59ICBcclxuXHJcbi8vIGZvcmdldCBwYXNzd29yZCBBUElcclxuZXhwb3J0IGNvbnN0IGZvcmdldFBhc3N3b3JkID0gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSkgOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgeyBuYW1lLCBlbWFpbCB9ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IGVtYWlsLCBuYW1lIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoeyBtZXNzYWdlOiBcIkludmFsaWQgY3JlZGVudGlhbHMuIFVzZXIgbm90IGZvdW5kLlwiLCByZXMsIHN0YXR1czogNDA0IH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdGVtcFBhc3N3b3JkID0gZ2VuZXJhdGVTZWN1cmVQYXNzd29yZCgpO1xyXG4gICAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGVtcFBhc3N3b3JkLCAxMik7XHJcblxyXG4gICAgICAgIHVzZXIucGFzc3dvcmQgPSBoYXNoZWRQYXNzd29yZDtcclxuICAgICAgICB1c2VyLmlzVGVtcFBhc3N3b3JkID0gdHJ1ZTtcclxuICAgICAgICB1c2VyLnBhc3N3b3JkQ2hhbmdlZEF0ID0gbmV3IERhdGUoKTtcclxuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IGZyb206IHN0cmluZyA9IGBcIkd1YXJkaWFuIEdyb3ZlXCIgPCR7cHJvY2Vzcy5lbnYuRU1BSUxfVVNFUk5BTUV9PmA7XHJcbiAgICAgICAgY29uc3QgdG86IHN0cmluZyA9IGVtYWlsO1xyXG4gICAgICAgIGNvbnN0IHN1YmplY3Q6IHN0cmluZyA9IFwiWW91ciBUZW1wb3JhcnkgUGFzc3dvcmRcIjtcclxuXHJcbiAgICAgICAgY29uc3QgaHRtbDogc3RyaW5nID0gYFxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bztcIj5cclxuICAgICAgICAgICAgICAgIDxoMiBzdHlsZT1cImNvbG9yOiAjMmMzZTUwO1wiPkhlbGxvICR7dXNlci5uYW1lfSw8L2gyPlxyXG4gICAgICAgICAgICAgICAgPHA+WW91ciB0ZW1wb3JhcnkgcGFzc3dvcmQgaXM6IDxzdHJvbmc+JHt0ZW1wUGFzc3dvcmR9PC9zdHJvbmc+PC9wPlxyXG4gICAgICAgICAgICAgICAgPHA+VGhpcyBwYXNzd29yZCB3aWxsIGV4cGlyZSBpbiAxIGhvdXIuPC9wPlxyXG4gICAgICAgICAgICAgICAgPHA+UGxlYXNlIHVzZSB0aGlzIHRvIGxvZ2luIGFuZCBjaGFuZ2UgeW91ciBwYXNzd29yZCBpbW1lZGlhdGVseS48L3A+XHJcbiAgICAgICAgICAgICAgICA8YnIvPlxyXG4gICAgICAgICAgICAgICAgPHA+VGhhbmsgeW91LDwvcD5cclxuICAgICAgICAgICAgICAgIDxwPjxzdHJvbmc+R3VhcmRpYW4gR3JvdmUgVGVhbTwvc3Ryb25nPjwvcD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYFxyXG5cclxuICAgICAgICAvLyBTZW5kIGVtYWlsIHdpdGggdGhlIHRlbXBvcmFyeSBwYXNzd29yZFxyXG4gICAgICAgIGF3YWl0IHNlbmRNYWlsKGZyb20sIHRvLCBzdWJqZWN0LCBodG1sKTtcclxuXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiBcIlRlbXBvcmFyeSBwYXNzd29yZCBzZW50IHRvIHlvdXIgZW1haWwuXCIgfSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih7IG1lc3NhZ2U6IFwiRXJyb3Igc2VuZGluZyB0ZW1wb3JhcnkgcGFzc3dvcmQuXCIsIHJlcywgc3RhdHVzOiA1MDB9KTtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJmb3JnZXRQYXNzd29yZCIsImxvZ2luIiwicmVnaXN0ZXIiLCJkb3RlbnYiLCJjb25maWciLCJKV1RfU0VDUkVUX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwicmVxIiwicmVzIiwibmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidGhyb3dFcnJvciIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJ1c2VyIiwiVXNlciIsImZpbmRPbmUiLCJpc01hdGNoIiwiYmNyeXB0IiwiY29tcGFyZSIsInRva2VuIiwiand0Iiwic2lnbiIsInVzZXJJZCIsImlkIiwicm9sZSIsImpzb24iLCJyZXF1aXJlc1Bhc3N3b3JkQ2hhbmdlIiwiaXNUZW1wUGFzc3dvcmQiLCJlcnJvciIsImRhdGEiLCJjb25maXJtUGFzc3dvcmQiLCJiaXJ0aGRheSIsImdlbmRlciIsImF2YXRhciIsImludGVyZXN0cyIsImZhbWlseU5hbWUiLCJmYW1pbHlBdmF0YXIiLCJlbWFpbFJlZ2V4IiwidGVzdCIsInZhbGlkUm9sZXMiLCJpbmNsdWRlcyIsIkFycmF5IiwiaXNBcnJheSIsInZhbGlkR2VuZGVycyIsImlzTmFOIiwiRGF0ZSIsImdldFRpbWUiLCJwYXNzd29yZFJlZ2V4IiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwiZmFtaWx5IiwiRmFtaWx5IiwibWVtYmVycyIsImNyZWF0ZWRBdCIsInNhdmUiLCJleGlzdGluZ0ZhbWlseU1lbWJlciIsImZhbWlseUlkIiwiX2lkIiwibmV3VXNlciIsImNyZWF0ZSIsInB1c2giLCJzZW5kIiwidGVtcFBhc3N3b3JkIiwiZ2VuZXJhdGVTZWN1cmVQYXNzd29yZCIsInBhc3N3b3JkQ2hhbmdlZEF0IiwiZnJvbSIsIkVNQUlMX1VTRVJOQU1FIiwidG8iLCJzdWJqZWN0IiwiaHRtbCIsInNlbmRNYWlsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQXFLYUE7ZUFBQUE7O1FBckpBQztlQUFBQTs7UUE0Q0FDO2VBQUFBOzs7K0RBM0RNO3VCQUNROzJCQUNOOytEQUNGO3FFQUNIOzZCQUNPO3dDQUNnQjs4QkFDZDs7Ozs7O0FBRXpCQyxlQUFNLENBQUNDLE1BQU07QUFFYixNQUFNQyxpQkFBaUJDLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVTtBQUl0QyxNQUFNUCxRQUFRLE9BQVFRLEtBQWNDO0lBRXZDLElBQUc7UUFDQyxNQUFNLEVBQUNDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUMsR0FBR0osSUFBSUssSUFBSTtRQUV4QyxJQUFJLENBQUNILFFBQVEsQ0FBQ0MsU0FBUyxDQUFDQyxVQUFVO1lBQzlCLE9BQU9FLElBQUFBLGlCQUFVLEVBQUM7Z0JBQUVDLFNBQVM7Z0JBQTJDTjtnQkFBS08sUUFBUTtZQUFJO1FBQzdGO1FBRUEsTUFBTUMsT0FBTyxNQUFNQyxlQUFJLENBQUNDLE9BQU8sQ0FBQztZQUM1QlQsTUFBTUE7WUFDTkMsT0FBT0E7UUFDWDtRQUVBLElBQUksQ0FBQ00sTUFBTTtZQUNQLE9BQU9ILElBQUFBLGlCQUFVLEVBQUM7Z0JBQUVDLFNBQVM7Z0JBQXdDTjtnQkFBS08sUUFBUTtZQUFJO1FBQzFGO1FBRUEsa0JBQWtCO1FB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